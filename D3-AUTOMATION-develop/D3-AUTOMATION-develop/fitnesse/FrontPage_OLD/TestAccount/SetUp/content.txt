!*****> Imports & DB Connection
|Import fixture|
|dbfit.fixture|

!|DatabaseEnvironment|sqlserver|
|Connect|${dbURL}|${dbUserName}|${dbUserName}|${dbName}|

!|dbfit.fixture.DatabaseEnvironment|
|set option|bind symbols|true|

!|smartrics.rest.fitnesse.fixture.RestFixtureConfig|
|http.client.connection.timeout|10000|

****!
!*****> Variables
!define charValue !-{~`@#$%^&*()_+-=[{}]|:;'?,./}-!
!define longValue {01234567890testfitne_s01234567890testfitne_s01234567890testfitne_s01234567890testfitne_s01234567890testfitne_s}
!define numValue {0123456789}
!define stringInput {ThisIsTEstStringValue}
!define userLoginID {fitTestLogin}
!define personFirstName {Arna}
!define branchID {1}
!define companyID {1}
****!
!*****> Setup Settings

!|Query|!-SELECT (CASE WHEN DAY(SYSDATETIME()) = '1' THEN '1.0' ELSE CONVERT(varchar, DAY(DATEADD(DAY, -0, SYSDATETIME()))) END) as Day,
                 (CASE WHEN LEN(DAY(SYSDATETIME()))=1 THEN '0' + CONVERT(varchar,DAY(SYSDATETIME())) ELSE CONVERT(varchar,DAY(SYSDATETIME())) END) as Day1,
                 Year(SYSDATETIME()) as Year, 
                 Month(SYSDATETIME()) as Month, 
                (CASE WHEN Month(SYSDATETIME()) = '1' THEN '1.0' ELSE CONVERT(varchar, MONTH(DATEADD(MONTH, -0, SYSDATETIME()))) END) as Month1, 
                (CASE WHEN LEN(Month(SYSDATETIME()))=1 THEN '0' + CONVERT(varchar,Month(SYSDATETIME())) ELSE CONVERT(varchar,Month(SYSDATETIME())) END) as Month2,
                DAY(DATEADD(s,-1,DATEADD(mm, DATEDIFF(m,0,GETDATE())+1,0))) as lastDay, 
                MONTH(DATEADD(MONTH, -1, SYSDATETIME())) as lastMonth, 
                (CASE WHEN Month(DATEADD(MONTH, -1, SYSDATETIME())) = '1' THEN '1.0' ELSE CONVERT(varchar, MONTH(DATEADD(MONTH, -1, SYSDATETIME())))  END) as lastMonth1-!|
|Day?|Day1?|Year?|Month?|Month1?|lastDay?|lastMonth?|lastMonth1?|Month2?|
|>>todayDay|>>todayDay2|>>todayYear|>>todayMonth|>>todayMonth1|>>lastDayOfCurrentMonth|>>lastMonth|>>lastMonth1|>>todayMonth2|

!|Query|!- select USER_ID from [OLB_USER] where LOGIN_ID = '-!${userName}'|
|USER_ID?|
|>>userID|

!|Execute|!-update [CREDENTIALS] set PASSWORD = 'q7hmqEHHFhwpUxzeJyp2vMS4BrN1YvEp+Q9HvhQudtY=' where PROFILE_NAME = 'user1 DEFAULT'
            update COMPANY_ATTRIBUTES set ATTRIBUTE_VALUE = 'flow.username.password.then.question' where ATTRIBUTE_NAME = 'attr.login.flow.id' and COMPANY_STRUCTURE_ID = 1-!|

!|Execute|!-delete from [TERMS_OF_SERVICE_ACCEPTANCE] where USER_LOGIN_ID = '-!${userName}!-'
            delete from [TERMS_OF_SERVICE_ACCEPTANCE] where USER_LOGIN_ID = '-!${userLoginID}!-'-!|

!|Execute|!-delete FROM [OLB_USER] where LOGIN_ID like 'fitTestLogin%' or LOGIN_ID like 'PasswordIsDisqualify%'
            delete FROM [ADMIN_USER] where LOGIN_ID like 'fitTestLogin%' or LOGIN_ID like 'PasswordIsDisqualify%'
            delete FROM [PERSON] where LAST_NAME = 'Badyelkhan'
            delete FROM [ADDRESS] where ADDRESS1 = '1234 Admin Ln' or ADDRESS1 = '5555 Cornhusker Highway'
            delete FROM [CREDENTIALS] where PROFILE_NAME like 'fitTestLogin%' or PROFILE_NAME like 'PasswordIsDisqualify%'
            delete FROM [TERMS_OF_SERVICE_ACCEPTANCE] where USER_LOGIN_ID like 'fitTestLogin%' -!|

!|DatabaseEnvironment|
|commit|
****!
!*****> !style_green[1. SECURITY]
!*****> '''1.1 Consumer User'''
'''1.1.1 Sign In (no/none existing apiKey value )'''
|!-smartrics.rest.fitnesse.fixture.RestFixture-!|http://${serverName}/d3rest/challenge|
|setHeader|!- appKey : null
Content-Type : application/json
Accept : application/json-!|
|setBody|!-{"AuthenticationChallenge":{"authToken":null,"isAuthenticated":null,"errorMessage":null,"nextChallenge":null,"currentChallenge":null,"isChallengeSuccess":null,"challengeList":null}}-!|
|POST||403|||
|setHeader|!- appKey : 20
Content-Type : application/json
Accept : application/json-!|
|setBody|!-{"AuthenticationChallenge":{"authToken":null,"isAuthenticated":null,"errorMessage":null,"nextChallenge":null,"currentChallenge":null,"isChallengeSuccess":null,"challengeList":null}}-!|
|POST||403|||

'''1.1.2 Sign In (incorrect user name/password)'''
|!-smartrics.rest.fitnesse.fixture.RestFixture-!|http://${serverName}/d3rest/challenge|
|setHeader|!- appKey : -!${institutionNum}!- 
Content-Type : application/json
Accept : application/json-!|
|setBody|!-{"AuthenticationChallenge":{"authToken":null,"isAuthenticated":false,"errorMessage":null,"nextChallenge":"challenge.type.username.and.password","currentChallenge":"challenge.type.username.and.password","isChallengeSuccess":true,"challengeList":[{"AuthenticationChallengeItem":{"key":"challenge.item.type.username","value":"IncorrectUserName"}},{"AuthenticationChallengeItem":{"key":"challenge.item.type.password","value":"-!${userPassword}!-"}}]}}-!|
|POST||200|||
|let|errorMsg|js|response.jsonbody.AuthenticationChallenge.errorMessage|invalid.credentials|
|let|auth|js|response.jsonbody.AuthenticationChallenge.isAuthenticated|false|
|let|auth|js|response.jsonbody.AuthenticationChallenge.isChallengeSuccess|false|
|setBody|!-{"AuthenticationChallenge":{"authToken":null,"isAuthenticated":false,"errorMessage":null,"nextChallenge":"challenge.type.username.and.password","currentChallenge":"challenge.type.username.and.password","isChallengeSuccess":true,"challengeList":[{"AuthenticationChallengeItem":{"key":"challenge.item.type.username","value":"-!${userName}!-"}},{"AuthenticationChallengeItem":{"key":"challenge.item.type.password","value":"IncorrectPassword"}}]}}-!|
|POST||200|||
|let|errorMsg|js|response.jsonbody.AuthenticationChallenge.errorMessage|invalid.credentials|
|let|auth|js|response.jsonbody.AuthenticationChallenge.isAuthenticated|false|
|let|auth|js|response.jsonbody.AuthenticationChallenge.isChallengeSuccess|false|

'''1.1.3 Sign In (login succeed)'''

|!-smartrics.rest.fitnesse.fixture.RestFixture-!|http://${serverName}/d3rest/challenge|
|setHeader|!- appKey : -!${institutionNum}!- 
Content-Type : application/json
Accept : application/json-!|
|setBody|!-{"AuthenticationChallenge":{"authToken":null,"isAuthenticated":null,"errorMessage":null,"nextChallenge":null,"currentChallenge":null,"isChallengeSuccess":null,"challengeList":null}}-!|
|POST||200|||
|let|errorMsg|js|response.jsonbody.AuthenticationChallenge.errorMessage|null|
|let|auth|js|response.jsonbody.AuthenticationChallenge.isAuthenticated|false|
|setBody|!-{"AuthenticationChallenge":{"authToken":null,"isAuthenticated":false,"errorMessage":null,"nextChallenge":"challenge.type.username.and.password","currentChallenge":"challenge.type.username.and.password","isChallengeSuccess":true,"challengeList":[{"AuthenticationChallengeItem":{"key":"challenge.item.type.username","value":"-!${userName}!-"}},{"AuthenticationChallengeItem":{"key":"challenge.item.type.password","value":"-!${userPassword}!-"}}]}}-!|
|POST||200|||
|let|$token|js|response.jsonbody.AuthenticationChallenge.authToken||
|let|errorMsg|js|response.jsonbody.AuthenticationChallenge.errorMessage|null|
|let|auth|js|response.jsonbody.AuthenticationChallenge.isAuthenticated|false|

!|com.lodosoftware.fitnesse.fixtures.LodosoftwareFixtures|
|symbolName|=getToken?|
|token|myToken|


'''1.1.4 Sign In (null/incorrect secret question answer)'''

|!-smartrics.rest.fitnesse.fixture.RestFixture-!|http://${serverName}/d3rest/challenge|
|setHeader|!- appKey : -!${institutionNum}!- 
Content-Type : application/json
Accept : application/json-!|
|setBody|!-{"AuthenticationChallenge":{"authToken":"-!%myToken%!-","isAuthenticated":false,"errorMessage":null,"nextChallenge":"challenge.type.secret.question","currentChallenge":"challenge.type.secret.question","isChallengeSuccess":true,"challengeList":[{"AuthenticationChallengeItem":{"key":"challenge.item.type.secret.question","value":null}}]}}-!|
|POST||200|||
|let|errorMsg|js|response.jsonbody.AuthenticationChallenge.errorMessage|!-ErrorCode: 40006 - Unable to find question-!|
|let|auth|js|response.jsonbody.AuthenticationChallenge.isAuthenticated|false|
|let|auth|js|response.jsonbody.AuthenticationChallenge.isChallengeSuccess|false|
|setBody|!-{"AuthenticationChallenge":{"authToken":"-!%myToken%!-","isAuthenticated":false,"errorMessage":null,"nextChallenge":"challenge.type.secret.question","currentChallenge":"challenge.type.secret.question","isChallengeSuccess":true,"challengeList":[{"AuthenticationChallengeItem":{"key":"challenge.item.type.secret.question","value":"IncorrectQuestion"}}]}}-!|
|POST||200|||
|let|errorMsg|js|response.jsonbody.AuthenticationChallenge.errorMessage|!-ErrorCode: 40007 - invalid.credentials-!|
|let|auth|js|response.jsonbody.AuthenticationChallenge.isAuthenticated|false|
|let|auth|js|response.jsonbody.AuthenticationChallenge.isChallengeSuccess|false|

'''1.1.5 Sign In (secret question answer succeed)'''

|!-smartrics.rest.fitnesse.fixture.RestFixture-!|http://${serverName}/d3rest/challenge|
|setHeader|!- appKey : -!${institutionNum}!- 
Content-Type : application/json
Accept : application/json-!|
|setBody|!-{"AuthenticationChallenge":{"authToken":"-!%myToken%!-","isAuthenticated":false,"errorMessage":null,"nextChallenge":"challenge.type.secret.question","currentChallenge":"challenge.type.secret.question","isChallengeSuccess":true,"challengeList":[{"AuthenticationChallengeItem":{"key":"challenge.item.type.secret.question","value":"-!${secretQuestionAnswer}!-"}}]}}-!|
|POST||200|||
|let|authenticated|js|response.jsonbody.AuthenticationChallenge.isAuthenticated|false|
|let|$userToken|js|response.jsonbody.AuthenticationChallenge.authToken||


'''1.1.6 Sign In (Disagree/Agree with TOS)'''

|!-smartrics.rest.fitnesse.fixture.RestFixture-!|http://${serverName}/d3rest/challenge|
|setHeader|!- appKey : -!${institutionNum}!- 
Content-Type : application/json
Accept : application/json-!|
|setBody|!-{
    "AuthenticationChallenge": {
        "authToken": "-!%encodedUserToken%!-", 
        "isAuthenticated": false, 
        "errorMessage": null, 
        "nextChallenge": "challenge.type.terms.of.service", 
        "currentChallenge": "challenge.type.secret.question", 
        "isChallengeSuccess": true, 
        "challengeList": [
            {
                "AuthenticationChallengeItem": {
                    "key": "challenge.item.type.terms.of.service", 
                    "value": ""
                }
            }
        ]
    }
}
-!|
|POST||200|||
|let||js|response.jsonbody.AuthenticationChallenge.isAuthenticated|false|
|let||js|response.jsonbody.AuthenticationChallenge.errorMessage|!-ErrorCode: 20004 - auth.session.not.found -!|
|setBody|!-{
    "AuthenticationChallenge": {
        "authToken": "-!%encodedUserToken%!-", 
        "isAuthenticated": false, 
        "errorMessage": null, 
        "nextChallenge": "challenge.type.terms.of.service", 
        "currentChallenge": "challenge.type.secret.question", 
        "isChallengeSuccess": true, 
        "challengeList": [
            {
                "AuthenticationChallengeItem": {
                    "key": "challenge.item.type.terms.of.service", 
                    "value": "false"
                }
            }
        ]
    }
}
-!|
|POST||200|||
|let||js|response.jsonbody.AuthenticationChallenge.isAuthenticated|false|
|let||js|response.jsonbody.AuthenticationChallenge.errorMessage|!-ErrorCode: 20004 - auth.session.not.found -!|
|setBody|!-{
    "AuthenticationChallenge": {
        "authToken": "-!%userToken%!-", 
        "isAuthenticated": false, 
        "errorMessage": null, 
        "nextChallenge": "challenge.type.terms.of.service", 
        "currentChallenge": "challenge.type.terms.of.service", 
        "isChallengeSuccess": true, 
        "challengeList": [
            {
                "AuthenticationChallengeItem": {
                    "key": "challenge.item.type.terms.of.service", 
                    "value": "true"
                }
            }
        ]
    }
}
-!|
|POST||200|||
|let||js|response.jsonbody.AuthenticationChallenge.isAuthenticated|true|
|let|$userToken|js|response.jsonbody.AuthenticationChallenge.authToken||

|!-org.eclg.fitnesse.tools.StringFixture-!|
|value| =urlencode()|
|%userToken%|encodedUserToken|


'''1.1.7 Sign In (user account locked out)'''

!|Execute|!-update [OLB_USER] set LOCKED = 1 where LOGIN_ID = '-!${userName}'|
!|DatabaseEnvironment|
|commit|

|!-smartrics.rest.fitnesse.fixture.RestFixture-!|http://${serverName}/d3rest/challenge|
|setHeader|!- appKey : -!${institutionNum}!- 
Content-Type : application/json
Accept : application/json-!|
|setBody|!-{"AuthenticationChallenge":{"authToken":null,"isAuthenticated":false,"errorMessage":null,"nextChallenge":"challenge.type.username.and.password","currentChallenge":"challenge.type.username.and.password","isChallengeSuccess":true,"challengeList":[{"AuthenticationChallengeItem":{"key":"challenge.item.type.username","value":"-!${userName}!-"}},{"AuthenticationChallengeItem":{"key":"challenge.item.type.password","value":"-!${userPassword}!-"}}]}}-!|
|POST||200|||

!|Execute|!-update [OLB_USER] set LOCKED = 0 where LOGIN_ID = '-!${userName}'|
!|DatabaseEnvironment|
|commit|

'''1.1.8 Sign In (user account disabled)'''

!|Execute|!-update [OLB_USER] set [USER_ENABLED]= 0 where LOGIN_ID = '-!${userName}'|
!|DatabaseEnvironment|
|commit|

|!-smartrics.rest.fitnesse.fixture.RestFixture-!|http://${serverName}/d3rest/challenge|
|setHeader|!- appKey : -!${institutionNum}!- 
Content-Type : application/json
Accept : application/json-!|
|setBody|!-{"AuthenticationChallenge":{"authToken":null,"isAuthenticated":false,"errorMessage":null,"nextChallenge":"challenge.type.username.and.password","currentChallenge":"challenge.type.username.and.password","isChallengeSuccess":true,"challengeList":[{"AuthenticationChallengeItem":{"key":"challenge.item.type.username","value":"-!${userName}!-"}},{"AuthenticationChallengeItem":{"key":"challenge.item.type.password","value":"-!${userPassword}!-"}}]}}-!|
|POST||200|||
|let|auth|js|response.jsonbody.AuthenticationChallenge.isAuthenticated|false|

!|Execute|!-update [OLB_USER] set [USER_ENABLED]= 1 where LOGIN_ID = '-!${userName}'|
!|DatabaseEnvironment|
|commit|

'''1.1.9 Sign In (password expired)'''

!|Execute|!-update [CREDENTIALS] set [PASSWORD_EXPIRATION_DATE] = '2012-09-10' where ID = (select CREDENTIALS_ID from [OLB_USER] where LOGIN_ID = '-!${userName}')|
!|DatabaseEnvironment|
|commit|

|!-smartrics.rest.fitnesse.fixture.RestFixture-!|http://${serverName}/d3rest/challenge|
|setHeader|!- appKey : -!${institutionNum}!- 
Content-Type : application/json
Accept : application/json-!|
|setBody|!-{"AuthenticationChallenge":{"authToken":null,"isAuthenticated":false,"errorMessage":null,"nextChallenge":"challenge.type.username.and.password","currentChallenge":"challenge.type.username.and.password","isChallengeSuccess":true,"challengeList":[{"AuthenticationChallengeItem":{"key":"challenge.item.type.username","value":"-!${userName}!-"}},{"AuthenticationChallengeItem":{"key":"challenge.item.type.password","value":"-!${userPassword}!-"}}]}}-!|
|POST||200|||
|let|auth|js|response.jsonbody.AuthenticationChallenge.isAuthenticated|false|

!|Execute|!-update [CREDENTIALS] set [PASSWORD_EXPIRATION_DATE] = '2020-09-10' where ID = (select CREDENTIALS_ID from [OLB_USER] where LOGIN_ID = '-!${userName}')|
!|DatabaseEnvironment|
|commit|
****!
!*****> '''1.2 System User'''
'''1.2.1 Sign In (no/none existing apiKey value )'''
|!-smartrics.rest.fitnesse.fixture.RestFixture-!|http://${serverName}/d3rest/challenge|
|setHeader|!- appKey : null
Content-Type : application/json
Accept : application/json-!|
|setBody|!-{"AuthenticationChallenge":{"authToken":null,"isAuthenticated":null,"errorMessage":null,"nextChallenge":null,"currentChallenge":null,"isChallengeSuccess":null,"challengeList":null}}-!|
|POST||403|||
|setHeader|!- appKey : 20
Content-Type : application/json
Accept : application/json-!|
|setBody|!-{"AuthenticationChallenge":{"authToken":null,"isAuthenticated":null,"errorMessage":null,"nextChallenge":null,"currentChallenge":null,"isChallengeSuccess":null,"challengeList":null}}-!|
|POST||403|||

'''1.2.2 Sign In (incorrect user name/password)'''
|!-smartrics.rest.fitnesse.fixture.RestFixture-!|http://${serverName}/d3rest/challenge|
|setHeader|!- appKey : -!${adminApiKey}!- 
Content-Type : application/json
Accept : application/json-!|
|setBody|!-{"AuthenticationChallenge":{"authToken":null,"isAuthenticated":false,"errorMessage":null,"nextChallenge":"challenge.type.username.and.password","currentChallenge":"challenge.type.username.and.password","isChallengeSuccess":true,"challengeList":[{"AuthenticationChallengeItem":{"key":"challenge.item.type.username","value":"IncorrectUserName"}},{"AuthenticationChallengeItem":{"key":"challenge.item.type.password","value":"-!${adminUserPassword}!-"}}]}}-!|
|POST||200|||
|let|errorMsg|js|response.jsonbody.AuthenticationChallenge.errorMessage|invalid.credentials|
|let|auth|js|response.jsonbody.AuthenticationChallenge.isAuthenticated|false|
|let|auth|js|response.jsonbody.AuthenticationChallenge.isChallengeSuccess|false|
|setBody|!-{"AuthenticationChallenge":{"authToken":null,"isAuthenticated":false,"errorMessage":null,"nextChallenge":"challenge.type.username.and.password","currentChallenge":"challenge.type.username.and.password","isChallengeSuccess":true,"challengeList":[{"AuthenticationChallengeItem":{"key":"challenge.item.type.username","value":"-!${adminUserName}!-"}},{"AuthenticationChallengeItem":{"key":"challenge.item.type.password","value":"IncorrectPassword"}}]}}-!|
|POST||200|||
|let|errorMsg|js|response.jsonbody.AuthenticationChallenge.errorMessage|invalid.credentials|
|let|auth|js|response.jsonbody.AuthenticationChallenge.isAuthenticated|false|
|let|auth|js|response.jsonbody.AuthenticationChallenge.isChallengeSuccess|false|
|comment| JIRA OLB-479 has been created for not returning error code|

'''1.2.3 Sign In (login succeed)'''

|!-smartrics.rest.fitnesse.fixture.RestFixture-!|http://${serverName}/d3rest/challenge|
|setHeader|!- appKey : -!${adminApiKey}!- 
Content-Type : application/json
Accept : application/json-!|
|setBody|!-{"AuthenticationChallenge":{"authToken":null,"isAuthenticated":null,"errorMessage":null,"nextChallenge":null,"currentChallenge":null,"isChallengeSuccess":null,"challengeList":null}}-!|
|POST||200|||
|let|errorMsg|js|response.jsonbody.AuthenticationChallenge.errorMessage|null|
|let|auth|js|response.jsonbody.AuthenticationChallenge.isAuthenticated|false|
|setBody|!-{"AuthenticationChallenge":{"authToken":null,"isAuthenticated":false,"errorMessage":null,"nextChallenge":"challenge.type.username.and.password","currentChallenge":"challenge.type.username.and.password","isChallengeSuccess":true,"challengeList":[{"AuthenticationChallengeItem":{"key":"challenge.item.type.username","value":"-!${adminUserName}!-"}},{"AuthenticationChallengeItem":{"key":"challenge.item.type.password","value":"-!${adminUserPassword}!-"}}]}}-!|
|POST||200|||
|let|$adminToken|js|response.jsonbody.AuthenticationChallenge.authToken||
|let|errorMsg|js|response.jsonbody.AuthenticationChallenge.errorMessage|null|
|let|auth|js|response.jsonbody.AuthenticationChallenge.isAuthenticated|false|

!|com.lodosoftware.fitnesse.fixtures.LodosoftwareFixtures|
|symbolName|=getToken?|
|adminToken|adminTokenRcvd|

'''1.2.4 Sign In (null/incorrect secret question answer)'''

|!-smartrics.rest.fitnesse.fixture.RestFixture-!|http://${serverName}/d3rest/challenge|
|setHeader|!- appKey : -!${adminApiKey}!- 
Content-Type : application/json
Accept : application/json-!|
|setBody|!-{"AuthenticationChallenge":{"authToken":"-!%adminTokenRcvd%!-","isAuthenticated":false,"errorMessage":null,"nextChallenge":"challenge.type.secret.question","currentChallenge":"challenge.type.secret.question","isChallengeSuccess":true,"challengeList":[{"AuthenticationChallengeItem":{"key":"challenge.item.type.secret.question","value":null}}]}}-!|
|POST||200|||
|let|errorMsg|js|response.jsonbody.AuthenticationChallenge.errorMessage|!-ErrorCode: 40006 - Unable to find question-!|
|let|auth|js|response.jsonbody.AuthenticationChallenge.isAuthenticated|false|
|let|auth|js|response.jsonbody.AuthenticationChallenge.isChallengeSuccess|false|
|setBody|!-{"AuthenticationChallenge":{"authToken":"-!%adminTokenRcvd%!-","isAuthenticated":false,"errorMessage":null,"nextChallenge":"challenge.type.secret.question","currentChallenge":"challenge.type.secret.question","isChallengeSuccess":true,"challengeList":[{"AuthenticationChallengeItem":{"key":"challenge.item.type.secret.question","value":"IncorrectQuestion"}}]}}-!|
|POST||200|||
|let|errorMsg|js|response.jsonbody.AuthenticationChallenge.errorMessage|!-ErrorCode: 40007 - invalid.credentials-!|
|let|auth|js|response.jsonbody.AuthenticationChallenge.isAuthenticated|false|
|let|auth|js|response.jsonbody.AuthenticationChallenge.isChallengeSuccess|false|

'''1.2.5 Sign In (secret question answer succeed)'''

|!-smartrics.rest.fitnesse.fixture.RestFixture-!|http://${serverName}/d3rest/challenge|
|setHeader|!- appKey : -!${adminApiKey}!- 
Content-Type : application/json
Accept : application/json-!|
|setBody|!-{"AuthenticationChallenge":{"authToken":"-!%adminTokenRcvd%!-","isAuthenticated":false,"errorMessage":null,"nextChallenge":"challenge.type.secret.question","currentChallenge":"challenge.type.secret.question","isChallengeSuccess":true,"challengeList":[{"AuthenticationChallengeItem":{"key":"challenge.item.type.secret.question","value":"-!${adminSecretQuestionAnswer}!-"}}]}}-!|
|POST||200|||
|let|authenticated|js|response.jsonbody.AuthenticationChallenge.isAuthenticated|true|
|let|$userAdminToken|js|response.jsonbody.AuthenticationChallenge.authToken||

|!-org.eclg.fitnesse.tools.StringFixture-!|
|value| =urlencode()|
|%userAdminToken%|encodedAdminUserToken|

'''1.2.6 Sign In (user account locked out)'''

!|Execute|!-update [OLB_USER] set LOCKED = 1 where LOGIN_ID = '-!${adminUserName}'|
!|DatabaseEnvironment|
|commit|

|!-smartrics.rest.fitnesse.fixture.RestFixture-!|http://${serverName}/d3rest/challenge|
|setHeader|!- appKey : -!${adminApiKey}!- 
Content-Type : application/json
Accept : application/json-!|
|setBody|!-{"AuthenticationChallenge":{"authToken":null,"isAuthenticated":false,"errorMessage":null,"nextChallenge":"challenge.type.username.and.password","currentChallenge":"challenge.type.username.and.password","isChallengeSuccess":true,"challengeList":[{"AuthenticationChallengeItem":{"key":"challenge.item.type.username","value":"-!${adminUserName}!-"}},{"AuthenticationChallengeItem":{"key":"challenge.item.type.password","value":"-!${adminUserPassword}!-"}}]}}-!|
|POST||200|||

!|Execute|!-update [OLB_USER] set LOCKED = 0 where LOGIN_ID = '-!${adminUserName}'|
!|DatabaseEnvironment|
|commit|

'''1.2.7 Sign In (user account disabled)'''

!|Execute|!-update [OLB_USER] set [USER_ENABLED]= 0 where LOGIN_ID = '-!${adminUserName}'|
!|DatabaseEnvironment|
|commit|

|!-smartrics.rest.fitnesse.fixture.RestFixture-!|http://${serverName}/d3rest/challenge|
|setHeader|!- appKey : -!${adminApiKey}!- 
Content-Type : application/json
Accept : application/json-!|
|setBody|!-{"AuthenticationChallenge":{"authToken":null,"isAuthenticated":false,"errorMessage":null,"nextChallenge":"challenge.type.username.and.password","currentChallenge":"challenge.type.username.and.password","isChallengeSuccess":true,"challengeList":[{"AuthenticationChallengeItem":{"key":"challenge.item.type.username","value":"-!${adminUserName}!-"}},{"AuthenticationChallengeItem":{"key":"challenge.item.type.password","value":"-!${adminUserPassword}!-"}}]}}-!|
|POST||200|||
|let|auth|js|response.jsonbody.AuthenticationChallenge.isAuthenticated|false|

!|Execute|!-update [OLB_USER] set [USER_ENABLED]= 1 where LOGIN_ID = '-!${adminUserName}'|
!|DatabaseEnvironment|
|commit|

'''1.2.8 Sign In (password expired)'''

!|Execute|!-update [CREDENTIALS] set [PASSWORD_EXPIRATION_DATE] = '2012-09-10' where ID = (select CREDENTIALS_ID from [OLB_USER] where LOGIN_ID = '-!${adminUserName}')|
!|DatabaseEnvironment|
|commit|

|!-smartrics.rest.fitnesse.fixture.RestFixture-!|http://${serverName}/d3rest/challenge|
|setHeader|!- appKey : -!${adminApiKey}!- 
Content-Type : application/json
Accept : application/json-!|
|setBody|!-{"AuthenticationChallenge":{"authToken":null,"isAuthenticated":false,"errorMessage":null,"nextChallenge":"challenge.type.username.and.password","currentChallenge":"challenge.type.username.and.password","isChallengeSuccess":true,"challengeList":[{"AuthenticationChallengeItem":{"key":"challenge.item.type.username","value":"-!${adminUserName}!-"}},{"AuthenticationChallengeItem":{"key":"challenge.item.type.password","value":"-!${adminUserPassword}!-"}}]}}-!|
|POST||200|||
|let|auth|js|response.jsonbody.AuthenticationChallenge.isAuthenticated|false|

!|Execute|!-update [CREDENTIALS] set [PASSWORD_EXPIRATION_DATE] = '2020-09-10' where ID = (select CREDENTIALS_ID from [OLB_USER] where LOGIN_ID = '-!${adminUserName}')|
!|DatabaseEnvironment|
|commit|
****!
!*****> '''1.3 Insight User'''
'''1.3.1 Sign In (no/none existing apiKey value )'''
|!-smartrics.rest.fitnesse.fixture.RestFixture-!|http://${serverName}/d3rest/challenge|
|setHeader|!- appKey : null
Content-Type : application/json
Accept : application/json-!|
|setBody|!-{"AuthenticationChallenge":{"authToken":null,"isAuthenticated":null,"errorMessage":null,"nextChallenge":null,"currentChallenge":null,"isChallengeSuccess":null,"challengeList":null}}-!|
|POST||403|||
|setHeader|!- appKey : 20
Content-Type : application/json
Accept : application/json-!|
|setBody|!-{"AuthenticationChallenge":{"authToken":null,"isAuthenticated":null,"errorMessage":null,"nextChallenge":null,"currentChallenge":null,"isChallengeSuccess":null,"challengeList":null}}-!|
|POST||403|||

'''1.3.2 Sign In (incorrect user name/password)'''
|!-smartrics.rest.fitnesse.fixture.RestFixture-!|http://${serverName}/d3rest/challenge|
|setHeader|!- appKey : -!${fiApiKey}!- 
Content-Type : application/json
Accept : application/json-!|
|setBody|!-{"AuthenticationChallenge":{"authToken":null,"isAuthenticated":false,"errorMessage":null,"nextChallenge":"challenge.type.username.and.password","currentChallenge":"challenge.type.username.and.password","isChallengeSuccess":true,"challengeList":[{"AuthenticationChallengeItem":{"key":"challenge.item.type.username","value":"IncorrectUserName"}},{"AuthenticationChallengeItem":{"key":"challenge.item.type.password","value":"-!${fiUserPassword}!-"}}]}}-!|
|POST||200|||
|let|errorMsg|js|response.jsonbody.AuthenticationChallenge.errorMessage|invalid.credentials|
|let|auth|js|response.jsonbody.AuthenticationChallenge.isAuthenticated|false|
|let|auth|js|response.jsonbody.AuthenticationChallenge.isChallengeSuccess|false|
|setBody|!-{"AuthenticationChallenge":{"authToken":null,"isAuthenticated":false,"errorMessage":null,"nextChallenge":"challenge.type.username.and.password","currentChallenge":"challenge.type.username.and.password","isChallengeSuccess":true,"challengeList":[{"AuthenticationChallengeItem":{"key":"challenge.item.type.username","value":"-!${fiUserName}!-"}},{"AuthenticationChallengeItem":{"key":"challenge.item.type.password","value":"IncorrectPassword"}}]}}-!|
|POST||200|||
|let|errorMsg|js|response.jsonbody.AuthenticationChallenge.errorMessage|invalid.credentials|
|let|auth|js|response.jsonbody.AuthenticationChallenge.isAuthenticated|false|
|let|auth|js|response.jsonbody.AuthenticationChallenge.isChallengeSuccess|false|
|comment| JIRA OLB-479 has been created for not returning error code|

'''1.3.3 Sign In (login succeed)'''

|!-smartrics.rest.fitnesse.fixture.RestFixture-!|http://${serverName}/d3rest/challenge|
|setHeader|!- appKey : -!${fiApiKey}!- 
Content-Type : application/json
Accept : application/json-!|
|setBody|!-{"AuthenticationChallenge":{"authToken":null,"isAuthenticated":null,"errorMessage":null,"nextChallenge":null,"currentChallenge":null,"isChallengeSuccess":null,"challengeList":null}}-!|
|POST||200|||
|let|errorMsg|js|response.jsonbody.AuthenticationChallenge.errorMessage|null|
|let|auth|js|response.jsonbody.AuthenticationChallenge.isAuthenticated|false|
|setBody|!-{"AuthenticationChallenge":{"authToken":null,"isAuthenticated":false,"errorMessage":null,"nextChallenge":"challenge.type.username.and.password","currentChallenge":"challenge.type.username.and.password","isChallengeSuccess":true,"challengeList":[{"AuthenticationChallengeItem":{"key":"challenge.item.type.username","value":"-!${fiUserName}!-"}},{"AuthenticationChallengeItem":{"key":"challenge.item.type.password","value":"-!${fiUserPassword}!-"}}]}}-!|
|POST||200|||
|let|$fiToken|js|response.jsonbody.AuthenticationChallenge.authToken||
|let|errorMsg|js|response.jsonbody.AuthenticationChallenge.errorMessage|null|
|let|auth|js|response.jsonbody.AuthenticationChallenge.isAuthenticated|false|

!|com.lodosoftware.fitnesse.fixtures.LodosoftwareFixtures|
|symbolName|=getToken?|
|fiToken|fiTokenRcvd|

'''1.3.4 Sign In (null/incorrect secret question answer)'''

|!-smartrics.rest.fitnesse.fixture.RestFixture-!|http://${serverName}/d3rest/challenge|
|setHeader|!- appKey : -!${fiApiKey}!- 
Content-Type : application/json
Accept : application/json-!|
|setBody|!-{"AuthenticationChallenge":{"authToken":"-!%fiTokenRcvd%!-","isAuthenticated":false,"errorMessage":null,"nextChallenge":"challenge.type.secret.question","currentChallenge":"challenge.type.secret.question","isChallengeSuccess":true,"challengeList":[{"AuthenticationChallengeItem":{"key":"challenge.item.type.secret.question","value":null}}]}}-!|
|POST||200|||
|let|errorMsg|js|response.jsonbody.AuthenticationChallenge.errorMessage|!-ErrorCode: 40006 - Unable to find question-!|
|let|auth|js|response.jsonbody.AuthenticationChallenge.isAuthenticated|false|
|let|auth|js|response.jsonbody.AuthenticationChallenge.isChallengeSuccess|false|
|setBody|!-{"AuthenticationChallenge":{"authToken":"-!%fiTokenRcvd%!-","isAuthenticated":false,"errorMessage":null,"nextChallenge":"challenge.type.secret.question","currentChallenge":"challenge.type.secret.question","isChallengeSuccess":true,"challengeList":[{"AuthenticationChallengeItem":{"key":"challenge.item.type.secret.question","value":"IncorrectQuestion"}}]}}-!|
|POST||200|||
|let|errorMsg|js|response.jsonbody.AuthenticationChallenge.errorMessage|!-ErrorCode: 40007 - invalid.credentials-!|
|let|auth|js|response.jsonbody.AuthenticationChallenge.isAuthenticated|false|
|let|auth|js|response.jsonbody.AuthenticationChallenge.isChallengeSuccess|false|

'''1.3.5 Sign In (secret question answer succeed)'''

|!-smartrics.rest.fitnesse.fixture.RestFixture-!|http://${serverName}/d3rest/challenge|
|setHeader|!- appKey : -!${fiApiKey}!- 
Content-Type : application/json
Accept : application/json-!|
|setBody|!-{"AuthenticationChallenge":{"authToken":"-!%fiTokenRcvd%!-","isAuthenticated":false,"errorMessage":null,"nextChallenge":"challenge.type.secret.question","currentChallenge":"challenge.type.secret.question","isChallengeSuccess":true,"challengeList":[{"AuthenticationChallengeItem":{"key":"challenge.item.type.secret.question","value":"-!${fiSecretQuestionAnswer}!-"}}]}}-!|
|POST||200|||
|let|authenticated|js|response.jsonbody.AuthenticationChallenge.isAuthenticated|true|
|let|$userFiToken|js|response.jsonbody.AuthenticationChallenge.authToken||

|!-org.eclg.fitnesse.tools.StringFixture-!|
|value| =urlencode()|
|%userFiToken%|fiEncodedUserToken|

'''1.3.6 Sign In (user account locked out)'''

!|Execute|!-update [OLB_USER] set LOCKED = 1 where LOGIN_ID = '-!${fiUserName}'|
!|DatabaseEnvironment|
|commit|

|!-smartrics.rest.fitnesse.fixture.RestFixture-!|http://${serverName}/d3rest/challenge|
|setHeader|!- appKey : -!${fiApiKey}!- 
Content-Type : application/json
Accept : application/json-!|
|setBody|!-{"AuthenticationChallenge":{"authToken":null,"isAuthenticated":false,"errorMessage":null,"nextChallenge":"challenge.type.username.and.password","currentChallenge":"challenge.type.username.and.password","isChallengeSuccess":true,"challengeList":[{"AuthenticationChallengeItem":{"key":"challenge.item.type.username","value":"-!${fiUserName}!-"}},{"AuthenticationChallengeItem":{"key":"challenge.item.type.password","value":"-!${fiUserPassword}!-"}}]}}-!|
|POST||200|||

!|Execute|!-update [OLB_USER] set LOCKED = 0 where LOGIN_ID = '-!${fiUserName}'|
!|DatabaseEnvironment|
|commit|

'''1.3.7 Sign In (user account disabled)'''

!|Execute|!-update [OLB_USER] set [USER_ENABLED]= 0 where LOGIN_ID = '-!${fiUserName}'|
!|DatabaseEnvironment|
|commit|

|!-smartrics.rest.fitnesse.fixture.RestFixture-!|http://${serverName}/d3rest/challenge|
|setHeader|!- appKey : -!${fiApiKey}!- 
Content-Type : application/json
Accept : application/json-!|
|setBody|!-{"AuthenticationChallenge":{"authToken":null,"isAuthenticated":false,"errorMessage":null,"nextChallenge":"challenge.type.username.and.password","currentChallenge":"challenge.type.username.and.password","isChallengeSuccess":true,"challengeList":[{"AuthenticationChallengeItem":{"key":"challenge.item.type.username","value":"-!${fiUserName}!-"}},{"AuthenticationChallengeItem":{"key":"challenge.item.type.password","value":"-!${fiUserPassword}!-"}}]}}-!|
|POST||200|||
|let|auth|js|response.jsonbody.AuthenticationChallenge.isAuthenticated|false|

!|Execute|!-update [OLB_USER] set [USER_ENABLED]= 1 where LOGIN_ID = '-!${fiUserName}'|
!|DatabaseEnvironment|
|commit|

'''1.3.8 Sign In (password expired)'''

!|Execute|!-update [CREDENTIALS] set [PASSWORD_EXPIRATION_DATE] = '2012-09-10' where ID = (select CREDENTIALS_ID from [OLB_USER] where LOGIN_ID = '-!${fiUserName}')|
!|DatabaseEnvironment|
|commit|

|!-smartrics.rest.fitnesse.fixture.RestFixture-!|http://${serverName}/d3rest/challenge|
|setHeader|!- appKey : -!${fiApiKey}!- 
Content-Type : application/json
Accept : application/json-!|
|setBody|!-{"AuthenticationChallenge":{"authToken":null,"isAuthenticated":false,"errorMessage":null,"nextChallenge":"challenge.type.username.and.password","currentChallenge":"challenge.type.username.and.password","isChallengeSuccess":true,"challengeList":[{"AuthenticationChallengeItem":{"key":"challenge.item.type.username","value":"-!${fiUserName}!-"}},{"AuthenticationChallengeItem":{"key":"challenge.item.type.password","value":"-!${fiUserPassword}!-"}}]}}-!|
|POST||200|||
|let|auth|js|response.jsonbody.AuthenticationChallenge.isAuthenticated|false|

!|Execute|!-update [CREDENTIALS] set [PASSWORD_EXPIRATION_DATE] = '2020-09-10' where ID = (select CREDENTIALS_ID from [OLB_USER] where LOGIN_ID = '-!${fiUserName}')|
!|DatabaseEnvironment|
|commit|
****!
****!
!*****> !style_green[1. USER]
!*****> '''1.1 POST USER'''
!*****> '''1.1.1 POST USER (/users)'''
!*****> '''1.1.1.1 System User - Create User'''
!*****> '''1.1.1.1 System User - Create System User'''
|!-smartrics.rest.fitnesse.fixture.RestFixture-!|http://${serverName}/d3rest/users|
|setHeader|!- appKey : -!${adminApiKey}!- 
Content-Type : application/json
userToken : %encodedAdminUserToken%-!|
|setBody|!-{
  "User" : {
    "loginId" : "-!${userLoginID}!-",
    "enabled" : true,
    "userType" : "system",
    "directId" : "fitDirectID",
    "person" : {
      "Person" : {
        "employee" : false,
        "firstName" : "-!${personFirstName}!-",
        "homePhone" : "303-666-6666",
        "id" : null,
        "lastName" : "Badyelkhan",
        "middleName" : "No Middle Name",
        "mobilePhone" : "720-555-5555",
        "primaryEmail" : "test@lodosoftware.com",
        "workPhone" : "920-456-7878",
        "alternateEmail" : "alternateEmail@lodosoftware.com",
        "mailingAddress" : {
          "Address" : {
            "line1" : "1234 Admin Ln",
            "line2" : "1235 Admin Ln",
            "line3" : "1236 Admin Ln",
            "line4" : "1237 Admin Ln",
            "city" : "AnyTown",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "12345",
            "state" : "CO"
          }
        },
        "physicalAddress" : {
          "Address" : {
            "line1" : "5555 Cornhusker Highway",
            "line2" : "5556 Cornhusker Highway",
            "line3" : null,
            "line4" : null,
            "city" : "Lincoln",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "45678",
            "state" : "NE"
          }
        }
      }
    },
    "credentials" : 
     {
      "Credentials" : {
        "password" : "password#1",
        "secretQuestions" : [ {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your mother's maiden name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What was your first pet's name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your favorite color?",
            "secretAnswer" : "denver"
          }
        } ]
      }
    }
  }
}-!|
|POST||200|||
|let|$userID1|js|!-response.jsonbody.User.userId-!||
|let||js|!-response.jsonbody.User.lastLoginDate-!|null|
|let||js|!-response.jsonbody.User.enabled-!|true|
|let||js|!-response.jsonbody.User.locked-!|false|
|let||js|!-response.jsonbody.User.loginId-!|${userLoginID}|
|let||js|!-response.jsonbody.User.person.Person.employee-!|false|
|let||js|!-response.jsonbody.User.person.Person.firstName-!|${personFirstName}|
|let||js|!-response.jsonbody.User.person.Person.homePhone-!|303-666-6666|
|let|$personID1|js|!-response.jsonbody.User.person.Person.id-!||
|let||js|!-response.jsonbody.User.person.Person.lastName-!|Badyelkhan|
|let||js|!-response.jsonbody.User.person.Person.middleName-!|No Middle Name|
|let||js|!-response.jsonbody.User.person.Person.mobilePhone-!|720-555-5555|
|let||js|!-response.jsonbody.User.person.Person.primaryEmail-!|!-test@lodosoftware.com-!|
|let||js|!-response.jsonbody.User.person.Person.workPhone-!|920-456-7878|
|let||js|!-response.jsonbody.User.person.Person.alternateEmail-!|!-alternateEmail@lodosoftware.com-!|
|let||js|!-response.jsonbody.User.person.Person.mailingAddress.Address.line1-!|1234 Admin Ln|
|let||js|!-response.jsonbody.User.person.Person.mailingAddress.Address.line2-!|1235 Admin Ln|
|let||js|!-response.jsonbody.User.person.Person.mailingAddress.Address.line3-!|1236 Admin Ln|
|let||js|!-response.jsonbody.User.person.Person.mailingAddress.Address.line4-!|1237 Admin Ln|
|let||js|!-response.jsonbody.User.person.Person.mailingAddress.Address.city-!|!-AnyTown-!|
|let||js|!-response.jsonbody.User.person.Person.mailingAddress.Address.countryCode-!|US|
|let||js|!-response.jsonbody.User.person.Person.mailingAddress.Address.geoCode-!|null|
|let|$mailingAddressID1|js|!-response.jsonbody.User.person.Person.mailingAddress.Address.id-!||
|let||js|!-response.jsonbody.User.person.Person.mailingAddress.Address.postalCode-!|12345|
|let||js|!-response.jsonbody.User.person.Person.mailingAddress.Address.state-!|CO|
|let||js|!-response.jsonbody.User.person.Person.physicalAddress.Address.line1-!|5555 Cornhusker Highway|
|let||js|!-response.jsonbody.User.person.Person.physicalAddress.Address.line2-!|5556 Cornhusker Highway|
|let||js|!-response.jsonbody.User.person.Person.physicalAddress.Address.line3-!|null|
|let||js|!-response.jsonbody.User.person.Person.physicalAddress.Address.line4-!|null|
|let||js|!-response.jsonbody.User.person.Person.physicalAddress.Address.city-!|Lincoln|
|let||js|!-response.jsonbody.User.person.Person.physicalAddress.Address.countryCode-!|US|
|let||js|!-response.jsonbody.User.person.Person.physicalAddress.Address.geoCode-!|null|
|let|$physicalAddressID1|js|!-response.jsonbody.User.person.Person.physicalAddress.Address.id-!||
|let||js|!-response.jsonbody.User.person.Person.physicalAddress.Address.postalCode-!|45678|
|let||js|!-response.jsonbody.User.person.Person.physicalAddress.Address.state-!|NE|
|let||js|!-response.jsonbody.User.ownerId-!||
|let||js|!-response.jsonbody.User.createdDate-!||
|let||js|!-response.jsonbody.User.updatedDate-!|null|
|let||js|!-response.jsonbody.User.userType-!|system|
|let||js|!-response.jsonbody.User.credentials-!|null|
|let||js|!-response.jsonbody.User.companyId-!||
|let||js|!-response.jsonbody.User.billpaySubscriberId-!|null|
|let||js|!-response.jsonbody.User.branchId-!|null|
|let||js|!-response.jsonbody.User.creditScore-!|null|
|let||js|!-response.jsonbody.User.creditScoreDate-!|null|
|let||js|!-response.jsonbody.User.dateOfBirth-!|null|
|let||js|!-response.jsonbody.User.directId-!|fitDirectID|
|let||js|!-response.jsonbody.User.directId2-!|null|
|let||js|!-response.jsonbody.User.emailOptOut-!|null|
|let||js|!-response.jsonbody.User.gender-!|null|
|let||js|!-response.jsonbody.User.income-!|null|
|let||js|!-response.jsonbody.User.interfaceId-!|null|
|let||js|!-response.jsonbody.User.markedForDelete-!|null|
|let||js|!-response.jsonbody.User.requiresFollowup-!|null|
|let||js|!-response.jsonbody.User.retirementAge-!|null|
|let||js|!-response.jsonbody.User.syncDate-!|null|
|let||js|!-response.jsonbody.User.taxId-!|null|
|let||js|!-response.jsonbody.User.taxIdType-!|null|
|let||js|!-response.jsonbody.User.userClass-!|null|
|comment|try to re-create using same data|
|setBody|!-{
  "User" : {
    "loginId" : "-!${userLoginID}!-",
    "enabled" : true,
    "userType" : "system",
    "directId" : "fitDirectID",
    "person" : {
      "Person" : {
        "employee" : false,
        "firstName" : "-!${personFirstName}!-",
        "homePhone" : "303-666-6666",
        "id" : null,
        "lastName" : "Badyelkhan",
        "middleName" : "No Middle Name",
        "mobilePhone" : "720-555-5555",
        "primaryEmail" : "test@lodosoftware.com",
        "workPhone" : "920-456-7878",
        "alternateEmail" : "alternateEmail@lodosoftware.com",
        "mailingAddress" : {
          "Address" : {
            "line1" : "1234 Admin Ln",
            "line2" : "1235 Admin Ln",
            "line3" : "1236 Admin Ln",
            "line4" : "1237 Admin Ln",
            "city" : "AnyTown",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "12345",
            "state" : "CO"
          }
        },
        "physicalAddress" : {
          "Address" : {
            "line1" : "5555 Cornhusker Highway",
            "line2" : "5556 Cornhusker Highway",
            "line3" : null,
            "line4" : null,
            "city" : "Lincoln",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "45678",
            "state" : "NE"
          }
        }
      }
    },
    "credentials" : 
     {
      "Credentials" : {
        "password" : "password#1",
        "secretQuestions" : [ {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your mother's maiden name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What was your first pet's name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your favorite color?",
            "secretAnswer" : "denver"
          }
        } ]
      }
    }
  }
}-!|
|POST||400|||
|let|$errMsg1|js|!-response.jsonbody.message-!||
|comment|loginID value is incorrect ex: "loginId" : "dsfsdfsdfsdfsa dfasdfsdfdsfsdfsdf"|
|setBody|!-{
  "User" : {
    "loginId" : "dsfsdfsdfsdfsa dfasdfsdfdsfsdfsdf",
    "enabled" : true,
    "userType" : "system",
    "directId" : "fitDirectID",
    "person" : {
      "Person" : {
        "employee" : false,
        "firstName" : "-!${personFirstName}!-",
        "homePhone" : "303-666-6666",
        "id" : null,
        "lastName" : "Badyelkhan",
        "middleName" : "No Middle Name",
        "mobilePhone" : "720-555-5555",
        "primaryEmail" : "test@lodosoftware.com",
        "workPhone" : "920-456-7878",
        "alternateEmail" : "alternateEmail@lodosoftware.com",
        "mailingAddress" : {
          "Address" : {
            "line1" : "1234 Admin Ln",
            "line2" : "1235 Admin Ln",
            "line3" : "1236 Admin Ln",
            "line4" : "1237 Admin Ln",
            "city" : "AnyTown",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "12345",
            "state" : "CO"
          }
        },
        "physicalAddress" : {
          "Address" : {
            "line1" : "5555 Cornhusker Highway",
            "line2" : "5556 Cornhusker Highway",
            "line3" : null,
            "line4" : null,
            "city" : "Lincoln",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "45678",
            "state" : "NE"
          }
        }
      }
    },
    "credentials" : 
     {
      "Credentials" : {
        "password" : "password#1",
        "secretQuestions" : [ {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your mother's maiden name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What was your first pet's name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your favorite color?",
            "secretAnswer" : "denver"
          }
        } ]
      }
    }
  }
}-!|
|POST||400|||
|let||js|!-response.jsonbody.message-!||
|comment|disqualifying password value|
|setBody|!-{
  "User" : {
    "loginId" : "PasswordIsDisqualify",
    "enabled" : true,
    "userType" : "system",
    "directId" : "fitDirectID",
    "person" : {
      "Person" : {
        "employee" : false,
        "firstName" : "-!${personFirstName}!-",
        "homePhone" : "303-666-6666",
        "id" : null,
        "lastName" : "Badyelkhan",
        "middleName" : "No Middle Name",
        "mobilePhone" : "720-555-5555",
        "primaryEmail" : "test@lodosoftware.com",
        "workPhone" : "920-456-7878",
        "alternateEmail" : "alternateEmail@lodosoftware.com",
        "mailingAddress" : {
          "Address" : {
            "line1" : "1234 Admin Ln",
            "line2" : "1235 Admin Ln",
            "line3" : "1236 Admin Ln",
            "line4" : "1237 Admin Ln",
            "city" : "AnyTown",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "12345",
            "state" : "CO"
          }
        },
        "physicalAddress" : {
          "Address" : {
            "line1" : "5555 Cornhusker Highway",
            "line2" : "5556 Cornhusker Highway",
            "line3" : null,
            "line4" : null,
            "city" : "Lincoln",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "45678",
            "state" : "NE"
          }
        }
      }
    },
    "credentials" : 
     {
      "Credentials" : {
        "password" : "12345645",
        "secretQuestions" : [ {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your mother's maiden name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What was your first pet's name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your favorite color?",
            "secretAnswer" : "denver"
          }
        } ]
      }
    }
  }
}-!|
|POST||200|||
|let|$nonExpectedUserID1|js|!-response.jsonbody.User.userId-!||
|let||js|!-response.jsonbody-!||
|comment|state value is higher than 3 varchar|
|setBody|!-{
  "User" : {
    "loginId" : "stateHigherThan3Char",
    "enabled" : true,
    "userType" : "system",
    "directId" : "fitDirectID",
    "person" : {
      "Person" : {
        "employee" : false,
        "firstName" : "-!${personFirstName}!-",
        "homePhone" : "303-666-6666",
        "id" : null,
        "lastName" : "Badyelkhan",
        "middleName" : "No Middle Name",
        "mobilePhone" : "720-555-5555",
        "primaryEmail" : "test@lodosoftware.com",
        "workPhone" : "920-456-7878",
        "alternateEmail" : "alternateEmail@lodosoftware.com",
        "mailingAddress" : {
          "Address" : {
            "line1" : "1234 Admin Ln",
            "line2" : "1235 Admin Ln",
            "line3" : "1236 Admin Ln",
            "line4" : "1237 Admin Ln",
            "city" : "AnyTown",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "12345",
            "state" : "Colorado"
          }
        },
        "physicalAddress" : {
          "Address" : {
            "line1" : "5555 Cornhusker Highway",
            "line2" : "5556 Cornhusker Highway",
            "line3" : null,
            "line4" : null,
            "city" : "Lincoln",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "45678",
            "state" : "NE"
          }
        }
      }
    },
    "credentials" : 
     {
      "Credentials" : {
        "password" : "password#1",
        "secretQuestions" : [ {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your mother's maiden name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What was your first pet's name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your favorite color?",
            "secretAnswer" : "denver"
          }
        } ]
      }
    }
  }
}-!|
|POST||400|||
|let||js|!-response.jsonbody.message-!||

#!|com.lodosoftware.fitnesse.fixtures.LodosoftwareFixtures|
#|symbolName|str|isContain?|
#|errMsg1|ErrorCode: 30075 - username.already.used|true|
****!
!*****> '''1.1.1.2 System User - Create Consumer User'''
|!-smartrics.rest.fitnesse.fixture.RestFixture-!|http://${serverName}/d3rest/users|
|setHeader|!- appKey : -!${adminApiKey}!- 
Content-Type : application/json
userToken : %encodedAdminUserToken%-!|
|setBody|!-{
  "User" : {
    "userId": null, 
    "loginId" : "-!${userLoginID}!-2",
    "enabled" : true,
    "userType" : "consumer",
    "directId" : "fitDirectID2",
    "directId2": "direcID2", 
    "branchId": "-!${branchID}!-", 
"dateOfBirth": null, 
    "gender": "F", 
"income": null, 
    "retirementAge": 65, 
    "taxId": "999-99-8888", 
    "taxIdType": "SSN", 
    "userClass": "DOUBLE-PLATNUM",
"billpaySubscriberId" : "testbillpaySubscriberId",
"creditScore" : "700",
"emailOptOut" : false,
"markedForDelete" : false,
"interfaceId" : 12,
    "person" : {
      "Person" : {
        "employee" : false,
        "firstName" : "-!${personFirstName}!-",
        "homePhone" : "303-666-6666",
        "id" : null,
        "lastName" : "Badyelkhan",
        "middleName" : "No Middle Name",
        "mobilePhone" : "720-555-5555",
        "primaryEmail" : "test@lodosoftware.com",
        "workPhone" : "920-456-7878",
        "alternateEmail" : "alternateEmail@lodosoftware.com",
        "mailingAddress" : {
          "Address" : {
            "line1" : "1234 Admin Ln",
            "line2" : "1235 Admin Ln",
            "line3" : "1236 Admin Ln",
            "line4" : "1237 Admin Ln",
            "city" : "AnyTown",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "12345",
            "state" : "CO"
          }
        },
        "physicalAddress" : {
          "Address" : {
            "line1" : "5555 Cornhusker Highway",
            "line2" : "5556 Cornhusker Highway",
            "line3" : null,
            "line4" : null,
            "city" : "Lincoln",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "45678",
            "state" : "NE"
          }
        }
      }
    },
    "credentials" : 
     {
      "Credentials" : {
        "password" : "password#2",
        "secretQuestions" : [ {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your mother's maiden name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What was your first pet's name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your favorite color?",
            "secretAnswer" : "denver"
          }
        } ]
      }
    }
  }
}-!|
|POST||200|||
|let|$userID2|js|!-response.jsonbody.User.userId-!||
|let||js|!-response.jsonbody.User.lastLoginDate-!|null|
|let||js|!-response.jsonbody.User.enabled-!|true|
|let||js|!-response.jsonbody.User.locked-!|false|
|let|$userLoginID2|js|!-response.jsonbody.User.loginId-!|${userLoginID}2|
|let||js|!-response.jsonbody.User.person.Person.employee-!|false|
|let||js|!-response.jsonbody.User.person.Person.firstName-!|${personFirstName}|
|let||js|!-response.jsonbody.User.person.Person.homePhone-!|303-666-6666|
|let|$personID2|js|!-response.jsonbody.User.person.Person.id-!||
|let||js|!-response.jsonbody.User.person.Person.lastName-!|Badyelkhan|
|let||js|!-response.jsonbody.User.person.Person.middleName-!|No Middle Name|
|let||js|!-response.jsonbody.User.person.Person.mobilePhone-!|720-555-5555|
|let||js|!-response.jsonbody.User.person.Person.primaryEmail-!|!-test@lodosoftware.com-!|
|let||js|!-response.jsonbody.User.person.Person.workPhone-!|920-456-7878|
|let||js|!-response.jsonbody.User.person.Person.alternateEmail-!|!-alternateEmail@lodosoftware.com-!|
|let||js|!-response.jsonbody.User.person.Person.mailingAddress.Address.line1-!|1234 Admin Ln|
|let||js|!-response.jsonbody.User.person.Person.mailingAddress.Address.line2-!|1235 Admin Ln|
|let||js|!-response.jsonbody.User.person.Person.mailingAddress.Address.line3-!|1236 Admin Ln|
|let||js|!-response.jsonbody.User.person.Person.mailingAddress.Address.line4-!|1237 Admin Ln|
|let||js|!-response.jsonbody.User.person.Person.mailingAddress.Address.city-!|!-AnyTown-!|
|let||js|!-response.jsonbody.User.person.Person.mailingAddress.Address.countryCode-!|US|
|let||js|!-response.jsonbody.User.person.Person.mailingAddress.Address.geoCode-!|null|
|let|$mailingAddressID2|js|!-response.jsonbody.User.person.Person.mailingAddress.Address.id-!||
|let||js|!-response.jsonbody.User.person.Person.mailingAddress.Address.postalCode-!|12345|
|let||js|!-response.jsonbody.User.person.Person.mailingAddress.Address.state-!|CO|
|let||js|!-response.jsonbody.User.person.Person.physicalAddress.Address.line1-!|5555 Cornhusker Highway|
|let||js|!-response.jsonbody.User.person.Person.physicalAddress.Address.line2-!|5556 Cornhusker Highway|
|let||js|!-response.jsonbody.User.person.Person.physicalAddress.Address.line3-!|null|
|let||js|!-response.jsonbody.User.person.Person.physicalAddress.Address.line4-!|null|
|let||js|!-response.jsonbody.User.person.Person.physicalAddress.Address.city-!|Lincoln|
|let||js|!-response.jsonbody.User.person.Person.physicalAddress.Address.countryCode-!|US|
|let||js|!-response.jsonbody.User.person.Person.physicalAddress.Address.geoCode-!|null|
|let|$physicalAddressID2|js|!-response.jsonbody.User.person.Person.physicalAddress.Address.id-!||
|let||js|!-response.jsonbody.User.person.Person.physicalAddress.Address.postalCode-!|45678|
|let||js|!-response.jsonbody.User.person.Person.physicalAddress.Address.state-!|NE|
|let||js|!-response.jsonbody.User.ownerId-!||
|let||js|!-response.jsonbody.User.createdDate-!||
|let||js|!-response.jsonbody.User.updatedDate-!||
|let||js|!-response.jsonbody.User.userType-!|consumer|
|let||js|!-response.jsonbody.User.credentials-!|null|
|let||js|!-response.jsonbody.User.companyId-!||
|let||js|!-response.jsonbody.User.billpaySubscriberId-!|null|
|let||js|!-response.jsonbody.User.branchId-!|1.0|
|let||js|!-response.jsonbody.User.creditScore-!|null|
|let||js|!-response.jsonbody.User.creditScoreDate-!|null|
|let||js|!-response.jsonbody.User.dateOfBirth-!|null|
|let||js|!-response.jsonbody.User.directId-!|fitDirectID2|
|let||js|!-response.jsonbody.User.directId2-!|direcID2|
|let||js|!-response.jsonbody.User.emailOptOut-!|false|
|let||js|!-response.jsonbody.User.gender-!|F|
|let||js|!-response.jsonbody.User.income-!|null|
|let||js|!-response.jsonbody.User.interfaceId-!|null|
|let||js|!-response.jsonbody.User.markedForDelete-!|null|
|let||js|!-response.jsonbody.User.requiresFollowup-!|false|
|let||js|!-response.jsonbody.User.retirementAge-!|65|
|let||js|!-response.jsonbody.User.syncDate-!|null|
|let||js|!-response.jsonbody.User.taxId-!|999-99-8888|
|let||js|!-response.jsonbody.User.taxIdType-!|SSN|
|let||js|!-response.jsonbody.User.userClass-!|DOUBLE-PLATNUM|
|comment|try to re-create using same data|
|setBody|!-{
  "User" : {
    "userId": null, 
    "loginId" : "-!${userLoginID}!-2",
    "enabled" : true,
    "userType" : "consumer",
    "directId" : "fitDirectID2",
    "directId2": "direcID2", 
    "branchId": "-!${branchID}!-", 
"dateOfBirth": null, 
    "gender": "F", 
"income": null, 
    "retirementAge": 65, 
    "taxId": "999-99-8888", 
    "taxIdType": "SSN", 
    "userClass": "DOUBLE-PLATNUM",
"billpaySubscriberId" : "testbillpaySubscriberId",
"creditScore" : "700",
"emailOptOut" : false,
"markedForDelete" : false,
"interfaceId" : 12,
    "person" : {
      "Person" : {
        "employee" : false,
        "firstName" : "-!${personFirstName}!-",
        "homePhone" : "303-666-6666",
        "id" : null,
        "lastName" : "Badyelkhan",
        "middleName" : "No Middle Name",
        "mobilePhone" : "720-555-5555",
        "primaryEmail" : "test@lodosoftware.com",
        "workPhone" : "920-456-7878",
        "alternateEmail" : "alternateEmail@lodosoftware.com",
        "mailingAddress" : {
          "Address" : {
            "line1" : "1234 Admin Ln",
            "line2" : "1235 Admin Ln",
            "line3" : "1236 Admin Ln",
            "line4" : "1237 Admin Ln",
            "city" : "AnyTown",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "12345",
            "state" : "CO"
          }
        },
        "physicalAddress" : {
          "Address" : {
            "line1" : "5555 Cornhusker Highway",
            "line2" : "5556 Cornhusker Highway",
            "line3" : null,
            "line4" : null,
            "city" : "Lincoln",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "45678",
            "state" : "NE"
          }
        }
      }
    },
    "credentials" : 
     {
      "Credentials" : {
        "password" : "password#2",
        "secretQuestions" : [ {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your mother's maiden name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What was your first pet's name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your favorite color?",
            "secretAnswer" : "denver"
          }
        } ]
      }
    }
  }
}-!|
|POST||400|||
|let|$errMsg1|js|!-response.jsonbody.message-!||
|comment|loginID value is incorrect ex: "loginId" : "dsfsdfsdfsdfsa dfasdfsdfdsfsdfsdf"|
|setBody|!-{
  "User" : {
    "loginId" : "dsfsdfsdfsdfsa dfasdfsdfdsfsdfsdf",
    "userId": null, 
    "enabled" : true,
    "userType" : "consumer",
    "directId" : "fitDirectID2",
    "directId2": "direcID2", 
    "branchId": "-!${branchID}!-", 
     "dateOfBirth": null, 
    "gender": "F", 
     "income": null, 
    "retirementAge": 65, 
    "taxId": "999-99-8888", 
    "taxIdType": "SSN", 
    "userClass": "DOUBLE-PLATNUM",
    "person" : {
      "Person" : {
        "employee" : false,
        "firstName" : "-!${personFirstName}!-",
        "homePhone" : "303-666-6666",
        "id" : null,
        "lastName" : "Badyelkhan",
        "middleName" : "No Middle Name",
        "mobilePhone" : "720-555-5555",
        "primaryEmail" : "test@lodosoftware.com",
        "workPhone" : "920-456-7878",
        "alternateEmail" : "alternateEmail@lodosoftware.com",
        "mailingAddress" : {
          "Address" : {
            "line1" : "1234 Admin Ln",
            "line2" : "1235 Admin Ln",
            "line3" : "1236 Admin Ln",
            "line4" : "1237 Admin Ln",
            "city" : "AnyTown",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "12345",
            "state" : "CO"
          }
        },
        "physicalAddress" : {
          "Address" : {
            "line1" : "5555 Cornhusker Highway",
            "line2" : "5556 Cornhusker Highway",
            "line3" : null,
            "line4" : null,
            "city" : "Lincoln",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "45678",
            "state" : "NE"
          }
        }
      }
    },
    "credentials" : 
     {
      "Credentials" : {
        "password" : "password#1",
        "secretQuestions" : [ {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your mother's maiden name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What was your first pet's name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your favorite color?",
            "secretAnswer" : "denver"
          }
        } ]
      }
    }
  }
}-!|
|POST||400|||
|let||js|!-response.jsonbody.message-!||
|comment|disqualifying password value|
|setBody|!-{
  "User" : {
    "loginId" : "PasswordIsDisqualify2",
    "userId": null, 
    "enabled" : true,
    "userType" : "consumer",
    "directId" : "fitDirectID2-2",
    "directId2": "direcID2-2", 
    "branchId": "-!${branchID}!-", 
     "dateOfBirth": null, 
    "gender": "F", 
     "income": null, 
    "retirementAge": 65, 
    "taxId": "999-99-8888", 
    "taxIdType": "SSN", 
    "userClass": "DOUBLE-PLATNUM",
    "person" : {
      "Person" : {
        "employee" : false,
        "firstName" : "-!${personFirstName}!-",
        "homePhone" : "303-666-6666",
        "id" : null,
        "lastName" : "Badyelkhan",
        "middleName" : "No Middle Name",
        "mobilePhone" : "720-555-5555",
        "primaryEmail" : "test@lodosoftware.com",
        "workPhone" : "920-456-7878",
        "alternateEmail" : "alternateEmail@lodosoftware.com",
        "mailingAddress" : {
          "Address" : {
            "line1" : "1234 Admin Ln",
            "line2" : "1235 Admin Ln",
            "line3" : "1236 Admin Ln",
            "line4" : "1237 Admin Ln",
            "city" : "AnyTown",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "12345",
            "state" : "CO"
          }
        },
        "physicalAddress" : {
          "Address" : {
            "line1" : "5555 Cornhusker Highway",
            "line2" : "5556 Cornhusker Highway",
            "line3" : null,
            "line4" : null,
            "city" : "Lincoln",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "45678",
            "state" : "NE"
          }
        }
      }
    },
    "credentials" : 
     {
      "Credentials" : {
        "password" : "12345645",
        "secretQuestions" : [ {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your mother's maiden name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What was your first pet's name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your favorite color?",
            "secretAnswer" : "denver"
          }
        } ]
      }
    }
  }
}-!|
|POST||200|||
|let||js|!-response.jsonbody-!||
|let|$nonExpectedUserID2|js|!-response.jsonbody.User.userId-!||
|comment|state value is higher than 3 varchar|
|setBody|!-{
  "User" : {
    "loginId" : "stateHigherThan3Char",
    "userId": null, 
    "enabled" : true,
    "userType" : "consumer",
    "directId" : "fitDirectID2",
    "directId2": "direcID2", 
    "branchId": "-!${branchID}!-", 
     "dateOfBirth": null, 
    "gender": "F", 
     "income": null, 
    "retirementAge": 65, 
    "taxId": "999-99-8888", 
    "taxIdType": "SSN", 
    "userClass": "DOUBLE-PLATNUM",
    "person" : {
      "Person" : {
        "employee" : false,
        "firstName" : "-!${personFirstName}!-",
        "homePhone" : "303-666-6666",
        "id" : null,
        "lastName" : "Badyelkhan",
        "middleName" : "No Middle Name",
        "mobilePhone" : "720-555-5555",
        "primaryEmail" : "test@lodosoftware.com",
        "workPhone" : "920-456-7878",
        "alternateEmail" : "alternateEmail@lodosoftware.com",
        "mailingAddress" : {
          "Address" : {
            "line1" : "1234 Admin Ln",
            "line2" : "1235 Admin Ln",
            "line3" : "1236 Admin Ln",
            "line4" : "1237 Admin Ln",
            "city" : "AnyTown",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "12345",
            "state" : "Colorado"
          }
        },
        "physicalAddress" : {
          "Address" : {
            "line1" : "5555 Cornhusker Highway",
            "line2" : "5556 Cornhusker Highway",
            "line3" : null,
            "line4" : null,
            "city" : "Lincoln",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "45678",
            "state" : "NE"
          }
        }
      }
    },
    "credentials" : 
     {
      "Credentials" : {
        "password" : "password#1",
        "secretQuestions" : [ {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your mother's maiden name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What was your first pet's name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your favorite color?",
            "secretAnswer" : "denver"
          }
        } ]
      }
    }
  }
}-!|
|POST||400|||
|let||js|!-response.jsonbody.message-!||
|comment|if branchID is null|
|setBody|!-{
  "User" : {
    "loginId" : "stateHigherThan3Char",
    "userId": null, 
    "enabled" : true,
    "userType" : "consumer",
    "directId" : "fitDirectID2",
    "directId2": "direcID2", 
    "branchId": null, 
     "dateOfBirth": null, 
    "gender": "F", 
     "income": null, 
    "retirementAge": 65, 
    "taxId": "999-99-8888", 
    "taxIdType": "SSN", 
    "userClass": "DOUBLE-PLATNUM",
    "person" : {
      "Person" : {
        "employee" : false,
        "firstName" : "-!${personFirstName}!-",
        "homePhone" : "303-666-6666",
        "id" : null,
        "lastName" : "Badyelkhan",
        "middleName" : "No Middle Name",
        "mobilePhone" : "720-555-5555",
        "primaryEmail" : "test@lodosoftware.com",
        "workPhone" : "920-456-7878",
        "alternateEmail" : "alternateEmail@lodosoftware.com",
        "mailingAddress" : {
          "Address" : {
            "line1" : "1234 Admin Ln",
            "line2" : "1235 Admin Ln",
            "line3" : "1236 Admin Ln",
            "line4" : "1237 Admin Ln",
            "city" : "AnyTown",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "12345",
            "state" : "Colorado"
          }
        },
        "physicalAddress" : {
          "Address" : {
            "line1" : "5555 Cornhusker Highway",
            "line2" : "5556 Cornhusker Highway",
            "line3" : null,
            "line4" : null,
            "city" : "Lincoln",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "45678",
            "state" : "NE"
          }
        }
      }
    },
    "credentials" : 
     {
      "Credentials" : {
        "password" : "password#1",
        "secretQuestions" : [ {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your mother's maiden name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What was your first pet's name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your favorite color?",
            "secretAnswer" : "denver"
          }
        } ]
      }
    }
  }
}-!|
|POST||400|||
|let|$errMsg2|js|!-response.jsonbody.message-!||

#!|com.lodosoftware.fitnesse.fixtures.LodosoftwareFixtures|
#|symbolName|str|isContain?|
#|errMsg1|!-ErrorCode: 30075 - username.already.used-!|true|
#|errMsg2|!-ErrorCode: 30086 - Specified branch could not be found-!|true|
****!
!*****> '''1.1.1.3 System User - Create Institution User'''
|!-smartrics.rest.fitnesse.fixture.RestFixture-!|http://${serverName}/d3rest/users|
|setHeader|!- appKey : -!${adminApiKey}!- 
Content-Type : application/json
userToken : %encodedAdminUserToken%-!|
|setBody|!-{
  "User" : {
    "userId": null, 
    "loginId" : "-!${userLoginID}!-3",
    "enabled" : true,
    "userType" : "institution",
    "directId" : "fitDirectID3",
    "directId2": "direcID3", 
    "branchId": "-!${branchID}!-", 
"dateOfBirth": null, 
    "gender": "F", 
"income": null, 
    "retirementAge": 65, 
    "taxId": "999-99-8888", 
    "taxIdType": "SSN", 
    "userClass": "DOUBLE-PLATNUM",
"billpaySubscriberId" : "testbillpaySubscriberId",
"creditScore" : "700",
"emailOptOut" : false,
"markedForDelete" : false,
"interfaceId" : 12,
    "companyId" : "-!${companyID}!-",
    "person" : {
      "Person" : {
        "employee" : false,
        "firstName" : "-!${personFirstName}!-",
        "homePhone" : "303-666-6666",
        "id" : null,
        "lastName" : "Badyelkhan",
        "middleName" : "No Middle Name",
        "mobilePhone" : "720-555-5555",
        "primaryEmail" : "test@lodosoftware.com",
        "workPhone" : "920-456-7878",
        "alternateEmail" : "alternateEmail@lodosoftware.com",
        "mailingAddress" : {
          "Address" : {
            "line1" : "1234 Admin Ln",
            "line2" : "1235 Admin Ln",
            "line3" : "1236 Admin Ln",
            "line4" : "1237 Admin Ln",
            "city" : "AnyTown",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "12345",
            "state" : "CO"
          }
        },
        "physicalAddress" : {
          "Address" : {
            "line1" : "5555 Cornhusker Highway",
            "line2" : "5556 Cornhusker Highway",
            "line3" : null,
            "line4" : null,
            "city" : "Lincoln",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "45678",
            "state" : "NE"
          }
        }
      }
    },
    "credentials" : 
     {
      "Credentials" : {
        "password" : "password#3",
        "secretQuestions" : [ {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your mother's maiden name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What was your first pet's name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your favorite color?",
            "secretAnswer" : "denver"
          }
        } ]
      }
    }
  }
}-!|
|POST||200|||
|let|$userID3|js|!-response.jsonbody.User.userId-!||
|let||js|!-response.jsonbody.User.lastLoginDate-!|null|
|let||js|!-response.jsonbody.User.enabled-!|true|
|let||js|!-response.jsonbody.User.locked-!|false|
|let|$userLoginID|js|!-response.jsonbody.User.loginId-!|${userLoginID}3|
|let||js|!-response.jsonbody.User.person.Person.employee-!|false|
|let||js|!-response.jsonbody.User.person.Person.firstName-!|${personFirstName}|
|let||js|!-response.jsonbody.User.person.Person.homePhone-!|303-666-6666|
|let|$personID3|js|!-response.jsonbody.User.person.Person.id-!||
|let||js|!-response.jsonbody.User.person.Person.lastName-!|Badyelkhan|
|let||js|!-response.jsonbody.User.person.Person.middleName-!|No Middle Name|
|let||js|!-response.jsonbody.User.person.Person.mobilePhone-!|720-555-5555|
|let||js|!-response.jsonbody.User.person.Person.primaryEmail-!|!-test@lodosoftware.com-!|
|let||js|!-response.jsonbody.User.person.Person.workPhone-!|920-456-7878|
|let||js|!-response.jsonbody.User.person.Person.alternateEmail-!|!-alternateEmail@lodosoftware.com-!|
|let||js|!-response.jsonbody.User.person.Person.mailingAddress.Address.line1-!|1234 Admin Ln|
|let||js|!-response.jsonbody.User.person.Person.mailingAddress.Address.line2-!|1235 Admin Ln|
|let||js|!-response.jsonbody.User.person.Person.mailingAddress.Address.line3-!|1236 Admin Ln|
|let||js|!-response.jsonbody.User.person.Person.mailingAddress.Address.line4-!|1237 Admin Ln|
|let||js|!-response.jsonbody.User.person.Person.mailingAddress.Address.city-!|!-AnyTown-!|
|let||js|!-response.jsonbody.User.person.Person.mailingAddress.Address.countryCode-!|US|
|let||js|!-response.jsonbody.User.person.Person.mailingAddress.Address.geoCode-!|null|
|let|$mailingAddressID3|js|!-response.jsonbody.User.person.Person.mailingAddress.Address.id-!||
|let||js|!-response.jsonbody.User.person.Person.mailingAddress.Address.postalCode-!|12345|
|let||js|!-response.jsonbody.User.person.Person.mailingAddress.Address.state-!|CO|
|let||js|!-response.jsonbody.User.person.Person.physicalAddress.Address.line1-!|5555 Cornhusker Highway|
|let||js|!-response.jsonbody.User.person.Person.physicalAddress.Address.line2-!|5556 Cornhusker Highway|
|let||js|!-response.jsonbody.User.person.Person.physicalAddress.Address.line3-!|null|
|let||js|!-response.jsonbody.User.person.Person.physicalAddress.Address.line4-!|null|
|let||js|!-response.jsonbody.User.person.Person.physicalAddress.Address.city-!|Lincoln|
|let||js|!-response.jsonbody.User.person.Person.physicalAddress.Address.countryCode-!|US|
|let||js|!-response.jsonbody.User.person.Person.physicalAddress.Address.geoCode-!|null|
|let|$physicalAddressID3|js|!-response.jsonbody.User.person.Person.physicalAddress.Address.id-!||
|let||js|!-response.jsonbody.User.person.Person.physicalAddress.Address.postalCode-!|45678|
|let||js|!-response.jsonbody.User.person.Person.physicalAddress.Address.state-!|NE|
|let||js|!-response.jsonbody.User.ownerId-!||
|let||js|!-response.jsonbody.User.createdDate-!||
|let||js|!-response.jsonbody.User.updatedDate-!|null|
|let||js|!-response.jsonbody.User.userType-!|institution|
|let||js|!-response.jsonbody.User.credentials-!|null|
|let||js|!-response.jsonbody.User.companyId-!||
|let||js|!-response.jsonbody.User.billpaySubscriberId-!|null|
|let||js|!-response.jsonbody.User.branchId-!|null|
|let||js|!-response.jsonbody.User.creditScore-!|null|
|let||js|!-response.jsonbody.User.creditScoreDate-!|null|
|let||js|!-response.jsonbody.User.dateOfBirth-!|null|
|let||js|!-response.jsonbody.User.directId-!|fitDirectID3|
|let||js|!-response.jsonbody.User.directId2-!|null|
|let||js|!-response.jsonbody.User.emailOptOut-!|null|
|let||js|!-response.jsonbody.User.gender-!|null|
|let||js|!-response.jsonbody.User.income-!|null|
|let||js|!-response.jsonbody.User.interfaceId-!|null|
|let||js|!-response.jsonbody.User.markedForDelete-!|null|
|let||js|!-response.jsonbody.User.requiresFollowup-!|null|
|let||js|!-response.jsonbody.User.retirementAge-!|null|
|let||js|!-response.jsonbody.User.syncDate-!|null|
|let||js|!-response.jsonbody.User.taxId-!|null|
|let||js|!-response.jsonbody.User.taxIdType-!|null|
|let||js|!-response.jsonbody.User.userClass-!|null|
|comment|try to re-create using same data|
|setBody|!-{
  "User" : {
    "userId": null, 
    "loginId" : "-!${userLoginID}!-3",
    "enabled" : true,
    "userType" : "institution",
    "directId" : "fitDirectID3",
    "directId2": "direcID3", 
    "branchId": "-!${branchID}!-", 
"dateOfBirth": null, 
    "gender": "F", 
"income": null, 
    "retirementAge": 65, 
    "taxId": "999-99-8888", 
    "taxIdType": "SSN", 
    "userClass": "DOUBLE-PLATNUM",
"billpaySubscriberId" : "testbillpaySubscriberId",
"creditScore" : "700",
"emailOptOut" : false,
"markedForDelete" : false,
"interfaceId" : 12,
    "companyId" : "-!${companyID}!-",
    "person" : {
      "Person" : {
        "employee" : false,
        "firstName" : "-!${personFirstName}!-",
        "homePhone" : "303-666-6666",
        "id" : null,
        "lastName" : "Badyelkhan",
        "middleName" : "No Middle Name",
        "mobilePhone" : "720-555-5555",
        "primaryEmail" : "test@lodosoftware.com",
        "workPhone" : "920-456-7878",
        "alternateEmail" : "alternateEmail@lodosoftware.com",
        "mailingAddress" : {
          "Address" : {
            "line1" : "1234 Admin Ln",
            "line2" : "1235 Admin Ln",
            "line3" : "1236 Admin Ln",
            "line4" : "1237 Admin Ln",
            "city" : "AnyTown",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "12345",
            "state" : "CO"
          }
        },
        "physicalAddress" : {
          "Address" : {
            "line1" : "5555 Cornhusker Highway",
            "line2" : "5556 Cornhusker Highway",
            "line3" : null,
            "line4" : null,
            "city" : "Lincoln",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "45678",
            "state" : "NE"
          }
        }
      }
    },
    "credentials" : 
     {
      "Credentials" : {
        "password" : "password#2",
        "secretQuestions" : [ {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your mother's maiden name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What was your first pet's name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your favorite color?",
            "secretAnswer" : "denver"
          }
        } ]
      }
    }
  }
}-!|
|POST||200|||
|let|$nonExpectedUserID5|js|!-response.jsonbody.User.userId-!||
|comment|loginID value is incorrect ex: "loginId" : "dsfsdfsdfsdfsa dfasdfsdfdsfsdfsdf"|
|setBody|!-{
  "User" : {
    "loginId" : "dsfsdfsdfsdfsa dfasdfsdfdsfsdfsdf",
    "userId": null, 
    "enabled" : true,
    "userType" : "institution",
    "directId" : "fitDirectID3",
    "directId2": "direcID3", 
    "branchId": "-!${branchID}!-", 
     "dateOfBirth": null, 
    "gender": "F", 
     "income": null, 
    "retirementAge": 65, 
    "taxId": "999-99-8888", 
    "taxIdType": "SSN", 
    "userClass": "DOUBLE-PLATNUM",
    "companyId" : "-!${companyID}!-",
    "person" : {
      "Person" : {
        "employee" : false,
        "firstName" : "-!${personFirstName}!-",
        "homePhone" : "303-666-6666",
        "id" : null,
        "lastName" : "Badyelkhan",
        "middleName" : "No Middle Name",
        "mobilePhone" : "720-555-5555",
        "primaryEmail" : "test@lodosoftware.com",
        "workPhone" : "920-456-7878",
        "alternateEmail" : "alternateEmail@lodosoftware.com",
        "mailingAddress" : {
          "Address" : {
            "line1" : "1234 Admin Ln",
            "line2" : "1235 Admin Ln",
            "line3" : "1236 Admin Ln",
            "line4" : "1237 Admin Ln",
            "city" : "AnyTown",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "12345",
            "state" : "CO"
          }
        },
        "physicalAddress" : {
          "Address" : {
            "line1" : "5555 Cornhusker Highway",
            "line2" : "5556 Cornhusker Highway",
            "line3" : null,
            "line4" : null,
            "city" : "Lincoln",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "45678",
            "state" : "NE"
          }
        }
      }
    },
    "credentials" : 
     {
      "Credentials" : {
        "password" : "password#1",
        "secretQuestions" : [ {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your mother's maiden name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What was your first pet's name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your favorite color?",
            "secretAnswer" : "denver"
          }
        } ]
      }
    }
  }
}-!|
|POST||400|||
|let||js|!-response.jsonbody.message-!||
|comment|disqualifying password value|
|setBody|!-{
  "User" : {
    "loginId" : "PasswordIsDisqualify3",
    "userId": null, 
    "enabled" : true,
    "userType" : "institution",
    "directId" : "fitDirectID3",
    "directId2": "direcID3", 
    "branchId": "-!${branchID}!-", 
     "dateOfBirth": null, 
    "gender": "F", 
     "income": null, 
    "retirementAge": 65, 
    "taxId": "999-99-8888", 
    "taxIdType": "SSN", 
    "userClass": "DOUBLE-PLATNUM",
    "companyId" : "-!${companyID}!-",
    "person" : {
      "Person" : {
        "employee" : false,
        "firstName" : "-!${personFirstName}!-",
        "homePhone" : "303-666-6666",
        "id" : null,
        "lastName" : "Badyelkhan",
        "middleName" : "No Middle Name",
        "mobilePhone" : "720-555-5555",
        "primaryEmail" : "test@lodosoftware.com",
        "workPhone" : "920-456-7878",
        "alternateEmail" : "alternateEmail@lodosoftware.com",
        "mailingAddress" : {
          "Address" : {
            "line1" : "1234 Admin Ln",
            "line2" : "1235 Admin Ln",
            "line3" : "1236 Admin Ln",
            "line4" : "1237 Admin Ln",
            "city" : "AnyTown",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "12345",
            "state" : "CO"
          }
        },
        "physicalAddress" : {
          "Address" : {
            "line1" : "5555 Cornhusker Highway",
            "line2" : "5556 Cornhusker Highway",
            "line3" : null,
            "line4" : null,
            "city" : "Lincoln",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "45678",
            "state" : "NE"
          }
        }
      }
    },
    "credentials" : 
     {
      "Credentials" : {
        "password" : "12345645",
        "secretQuestions" : [ {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your mother's maiden name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What was your first pet's name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your favorite color?",
            "secretAnswer" : "denver"
          }
        } ]
      }
    }
  }
}-!|
|POST||200|||
|let||js|!-response.jsonbody-!||
|let|$nonExpectedUserID3|js|!-response.jsonbody.User.userId-!||
|comment|state value is higher than 3 varchar|
|setBody|!-{
  "User" : {
    "loginId" : "stateHigherThan3Char",
    "userId": null, 
    "enabled" : true,
    "userType" : "institution",
    "directId" : "fitDirectID3",
    "directId2": "direcID3", 
    "branchId": "-!${branchID}!-", 
     "dateOfBirth": null, 
    "gender": "F", 
     "income": null, 
    "retirementAge": 65, 
    "taxId": "999-99-8888", 
    "taxIdType": "SSN", 
    "userClass": "DOUBLE-PLATNUM",
    "companyId" : "-!${companyID}!-",
    "person" : {
      "Person" : {
        "employee" : false,
        "firstName" : "-!${personFirstName}!-",
        "homePhone" : "303-666-6666",
        "id" : null,
        "lastName" : "Badyelkhan",
        "middleName" : "No Middle Name",
        "mobilePhone" : "720-555-5555",
        "primaryEmail" : "test@lodosoftware.com",
        "workPhone" : "920-456-7878",
        "alternateEmail" : "alternateEmail@lodosoftware.com",
        "mailingAddress" : {
          "Address" : {
            "line1" : "1234 Admin Ln",
            "line2" : "1235 Admin Ln",
            "line3" : "1236 Admin Ln",
            "line4" : "1237 Admin Ln",
            "city" : "AnyTown",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "12345",
            "state" : "Colorado"
          }
        },
        "physicalAddress" : {
          "Address" : {
            "line1" : "5555 Cornhusker Highway",
            "line2" : "5556 Cornhusker Highway",
            "line3" : null,
            "line4" : null,
            "city" : "Lincoln",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "45678",
            "state" : "NE"
          }
        }
      }
    },
    "credentials" : 
     {
      "Credentials" : {
        "password" : "password#1",
        "secretQuestions" : [ {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your mother's maiden name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What was your first pet's name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your favorite color?",
            "secretAnswer" : "denver"
          }
        } ]
      }
    }
  }
}-!|
|POST||400|||
|let||js|!-response.jsonbody.message-!||
|comment|if companyID is null|
|setBody|!-{
  "User" : {
    "loginId" : "stateHigherThan3Char",
    "userId": null, 
    "enabled" : true,
    "userType" : "institution",
    "directId" : "fitDirectID3",
    "directId2": "direcID3", 
    "branchId": "-!${branchID}!-", 
     "dateOfBirth": null, 
    "gender": "F", 
     "income": null, 
    "retirementAge": 65, 
    "taxId": "999-99-8888", 
    "taxIdType": "SSN", 
    "userClass": "DOUBLE-PLATNUM",
    "companyId" : null,
    "person" : {
      "Person" : {
        "employee" : false,
        "firstName" : "-!${personFirstName}!-",
        "homePhone" : "303-666-6666",
        "id" : null,
        "lastName" : "Badyelkhan",
        "middleName" : "No Middle Name",
        "mobilePhone" : "720-555-5555",
        "primaryEmail" : "test@lodosoftware.com",
        "workPhone" : "920-456-7878",
        "alternateEmail" : "alternateEmail@lodosoftware.com",
        "mailingAddress" : {
          "Address" : {
            "line1" : "1234 Admin Ln",
            "line2" : "1235 Admin Ln",
            "line3" : "1236 Admin Ln",
            "line4" : "1237 Admin Ln",
            "city" : "AnyTown",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "12345",
            "state" : "Colorado"
          }
        },
        "physicalAddress" : {
          "Address" : {
            "line1" : "5555 Cornhusker Highway",
            "line2" : "5556 Cornhusker Highway",
            "line3" : null,
            "line4" : null,
            "city" : "Lincoln",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "45678",
            "state" : "NE"
          }
        }
      }
    },
    "credentials" : 
     {
      "Credentials" : {
        "password" : "password#1",
        "secretQuestions" : [ {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your mother's maiden name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What was your first pet's name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your favorite color?",
            "secretAnswer" : "denver"
          }
        } ]
      }
    }
  }
}-!|
|POST||400|||
|let||js|!-response.jsonbody.message-!||
****!
!*****> '''1.1.1.4 System User - Create Insight User'''
|!-smartrics.rest.fitnesse.fixture.RestFixture-!|http://${serverName}/d3rest/users|
|setHeader|!- appKey : -!${adminApiKey}!- 
Content-Type : application/json
userToken : %encodedAdminUserToken%-!|
|setBody|!-{
  "User" : {
    "userId": null, 
    "loginId" : "-!${userLoginID}!-4",
    "enabled" : true,
    "userType" : "insight",
    "directId" : "fitDirectID4",
    "directId2": "direcID4", 
    "branchId": "-!${branchID}!-", 
"dateOfBirth": null, 
    "gender": "F", 
"income": null, 
    "retirementAge": 65, 
    "taxId": "999-99-8888", 
    "taxIdType": "SSN", 
    "userClass": "DOUBLE-PLATNUM",
"billpaySubscriberId" : "testbillpaySubscriberId",
"creditScore" : "700",
"emailOptOut" : false,
"markedForDelete" : false,
"interfaceId" : 12,
    "companyId" : "-!${companyID}!-",
    "person" : {
      "Person" : {
        "employee" : false,
        "firstName" : "-!${personFirstName}!-",
        "homePhone" : "303-666-6666",
        "id" : null,
        "lastName" : "Badyelkhan",
        "middleName" : "No Middle Name",
        "mobilePhone" : "720-555-5555",
        "primaryEmail" : "test@lodosoftware.com",
        "workPhone" : "920-456-7878",
        "alternateEmail" : "alternateEmail@lodosoftware.com",
        "mailingAddress" : {
          "Address" : {
            "line1" : "1234 Admin Ln",
            "line2" : "1235 Admin Ln",
            "line3" : "1236 Admin Ln",
            "line4" : "1237 Admin Ln",
            "city" : "AnyTown",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "12345",
            "state" : "CO"
          }
        },
        "physicalAddress" : {
          "Address" : {
            "line1" : "5555 Cornhusker Highway",
            "line2" : "5556 Cornhusker Highway",
            "line3" : null,
            "line4" : null,
            "city" : "Lincoln",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "45678",
            "state" : "NE"
          }
        }
      }
    },
    "credentials" : 
     {
      "Credentials" : {
        "password" : "password#4",
        "secretQuestions" : [ {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your mother's maiden name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What was your first pet's name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your favorite color?",
            "secretAnswer" : "denver"
          }
        } ]
      }
    }
  }
}-!|
|POST||200|||
|let|$userID4|js|!-response.jsonbody.User.userId-!||
|let||js|!-response.jsonbody.User.lastLoginDate-!|null|
|let||js|!-response.jsonbody.User.enabled-!|true|
|let||js|!-response.jsonbody.User.locked-!|false|
|let||js|!-response.jsonbody.User.loginId-!|${userLoginID}4|
|let||js|!-response.jsonbody.User.person.Person.employee-!|false|
|let||js|!-response.jsonbody.User.person.Person.firstName-!|${personFirstName}|
|let||js|!-response.jsonbody.User.person.Person.homePhone-!|303-666-6666|
|let|$personID4|js|!-response.jsonbody.User.person.Person.id-!||
|let||js|!-response.jsonbody.User.person.Person.lastName-!|Badyelkhan|
|let||js|!-response.jsonbody.User.person.Person.middleName-!|No Middle Name|
|let||js|!-response.jsonbody.User.person.Person.mobilePhone-!|720-555-5555|
|let||js|!-response.jsonbody.User.person.Person.primaryEmail-!|!-test@lodosoftware.com-!|
|let||js|!-response.jsonbody.User.person.Person.workPhone-!|920-456-7878|
|let||js|!-response.jsonbody.User.person.Person.alternateEmail-!|!-alternateEmail@lodosoftware.com-!|
|let||js|!-response.jsonbody.User.person.Person.mailingAddress.Address.line1-!|1234 Admin Ln|
|let||js|!-response.jsonbody.User.person.Person.mailingAddress.Address.line2-!|1235 Admin Ln|
|let||js|!-response.jsonbody.User.person.Person.mailingAddress.Address.line3-!|1236 Admin Ln|
|let||js|!-response.jsonbody.User.person.Person.mailingAddress.Address.line4-!|1237 Admin Ln|
|let||js|!-response.jsonbody.User.person.Person.mailingAddress.Address.city-!|!-AnyTown-!|
|let||js|!-response.jsonbody.User.person.Person.mailingAddress.Address.countryCode-!|US|
|let||js|!-response.jsonbody.User.person.Person.mailingAddress.Address.geoCode-!|null|
|let|$mailingAddressID4|js|!-response.jsonbody.User.person.Person.mailingAddress.Address.id-!||
|let||js|!-response.jsonbody.User.person.Person.mailingAddress.Address.postalCode-!|12345|
|let||js|!-response.jsonbody.User.person.Person.mailingAddress.Address.state-!|CO|
|let||js|!-response.jsonbody.User.person.Person.physicalAddress.Address.line1-!|5555 Cornhusker Highway|
|let||js|!-response.jsonbody.User.person.Person.physicalAddress.Address.line2-!|5556 Cornhusker Highway|
|let||js|!-response.jsonbody.User.person.Person.physicalAddress.Address.line3-!|null|
|let||js|!-response.jsonbody.User.person.Person.physicalAddress.Address.line4-!|null|
|let||js|!-response.jsonbody.User.person.Person.physicalAddress.Address.city-!|Lincoln|
|let||js|!-response.jsonbody.User.person.Person.physicalAddress.Address.countryCode-!|US|
|let||js|!-response.jsonbody.User.person.Person.physicalAddress.Address.geoCode-!|null|
|let|$physicalAddressID4|js|!-response.jsonbody.User.person.Person.physicalAddress.Address.id-!||
|let||js|!-response.jsonbody.User.person.Person.physicalAddress.Address.postalCode-!|45678|
|let||js|!-response.jsonbody.User.person.Person.physicalAddress.Address.state-!|NE|
|let||js|!-response.jsonbody.User.ownerId-!||
|let||js|!-response.jsonbody.User.createdDate-!||
|let||js|!-response.jsonbody.User.updatedDate-!|null|
|let||js|!-response.jsonbody.User.userType-!|insight|
|let||js|!-response.jsonbody.User.credentials-!|null|
|let||js|!-response.jsonbody.User.companyId-!||
|let||js|!-response.jsonbody.User.billpaySubscriberId-!|null|
|let||js|!-response.jsonbody.User.branchId-!|null|
|let||js|!-response.jsonbody.User.creditScore-!|null|
|let||js|!-response.jsonbody.User.creditScoreDate-!|null|
|let||js|!-response.jsonbody.User.dateOfBirth-!|null|
|let||js|!-response.jsonbody.User.directId-!|fitDirectID4|
|let||js|!-response.jsonbody.User.directId2-!|null|
|let||js|!-response.jsonbody.User.emailOptOut-!|null|
|let||js|!-response.jsonbody.User.gender-!|null|
|let||js|!-response.jsonbody.User.income-!|null|
|let||js|!-response.jsonbody.User.interfaceId-!|null|
|let||js|!-response.jsonbody.User.markedForDelete-!|null|
|let||js|!-response.jsonbody.User.requiresFollowup-!|null|
|let||js|!-response.jsonbody.User.retirementAge-!|null|
|let||js|!-response.jsonbody.User.syncDate-!|null|
|let||js|!-response.jsonbody.User.taxId-!|null|
|let||js|!-response.jsonbody.User.taxIdType-!|null|
|let||js|!-response.jsonbody.User.userClass-!|null|
|comment|try to re-create using same data|
|setBody|!-{
  "User" : {
    "userId": null, 
    "loginId" : "-!${userLoginID}!-4",
    "enabled" : true,
    "userType" : "insight",
    "directId" : "fitDirectID4",
    "directId2": "direcID4", 
    "branchId": "-!${branchID}!-", 
"dateOfBirth": null, 
    "gender": "F", 
"income": null, 
    "retirementAge": 65, 
    "taxId": "999-99-8888", 
    "taxIdType": "SSN", 
    "userClass": "DOUBLE-PLATNUM",
"billpaySubscriberId" : "testbillpaySubscriberId",
"creditScore" : "700",
"emailOptOut" : false,
"markedForDelete" : false,
"interfaceId" : 12,
    "companyId" : "-!${companyID}!-",
    "person" : {
      "Person" : {
        "employee" : false,
        "firstName" : "-!${personFirstName}!-",
        "homePhone" : "303-666-6666",
        "id" : null,
        "lastName" : "Badyelkhan",
        "middleName" : "No Middle Name",
        "mobilePhone" : "720-555-5555",
        "primaryEmail" : "test@lodosoftware.com",
        "workPhone" : "920-456-7878",
        "alternateEmail" : "alternateEmail@lodosoftware.com",
        "mailingAddress" : {
          "Address" : {
            "line1" : "1234 Admin Ln",
            "line2" : "1235 Admin Ln",
            "line3" : "1236 Admin Ln",
            "line4" : "1237 Admin Ln",
            "city" : "AnyTown",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "12345",
            "state" : "CO"
          }
        },
        "physicalAddress" : {
          "Address" : {
            "line1" : "5555 Cornhusker Highway",
            "line2" : "5556 Cornhusker Highway",
            "line3" : null,
            "line4" : null,
            "city" : "Lincoln",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "45678",
            "state" : "NE"
          }
        }
      }
    },
    "credentials" : 
     {
      "Credentials" : {
        "password" : "password#2",
        "secretQuestions" : [ {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your mother's maiden name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What was your first pet's name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your favorite color?",
            "secretAnswer" : "denver"
          }
        } ]
      }
    }
  }
}-!|
|POST||200|||
|let|$nonExpectedUserID6|js|!-response.jsonbody.User.userId-!||
|comment|loginID value is incorrect ex: "loginId" : "dsfsdfsdfsdfsa dfasdfsdfdsfsdfsdf"|
|setBody|!-{
  "User" : {
    "loginId" : "dsfsdfsdfsdfsa dfasdfsdfdsfsdfsdf",
    "userId": null, 
    "enabled" : true,
    "userType" : "insight",
    "directId" : "fitDirectID4",
    "directId2": "direcID4", 
    "branchId": "-!${branchID}!-", 
     "dateOfBirth": null, 
    "gender": "F", 
     "income": null, 
    "retirementAge": 65, 
    "taxId": "999-99-8888", 
    "taxIdType": "SSN", 
    "userClass": "DOUBLE-PLATNUM",
    "companyId" : "-!${companyID}!-",
    "person" : {
      "Person" : {
        "employee" : false,
        "firstName" : "-!${personFirstName}!-",
        "homePhone" : "303-666-6666",
        "id" : null,
        "lastName" : "Badyelkhan",
        "middleName" : "No Middle Name",
        "mobilePhone" : "720-555-5555",
        "primaryEmail" : "test@lodosoftware.com",
        "workPhone" : "920-456-7878",
        "alternateEmail" : "alternateEmail@lodosoftware.com",
        "mailingAddress" : {
          "Address" : {
            "line1" : "1234 Admin Ln",
            "line2" : "1235 Admin Ln",
            "line3" : "1236 Admin Ln",
            "line4" : "1237 Admin Ln",
            "city" : "AnyTown",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "12345",
            "state" : "CO"
          }
        },
        "physicalAddress" : {
          "Address" : {
            "line1" : "5555 Cornhusker Highway",
            "line2" : "5556 Cornhusker Highway",
            "line3" : null,
            "line4" : null,
            "city" : "Lincoln",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "45678",
            "state" : "NE"
          }
        }
      }
    },
    "credentials" : 
     {
      "Credentials" : {
        "password" : "password#1",
        "secretQuestions" : [ {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your mother's maiden name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What was your first pet's name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your favorite color?",
            "secretAnswer" : "denver"
          }
        } ]
      }
    }
  }
}-!|
|POST||400|||
|let||js|!-response.jsonbody.message-!||
|comment|disqualifying password value|
|setBody|!-{
  "User" : {
    "loginId" : "PasswordIsDisqualify4",
    "userId": null, 
    "enabled" : true,
    "userType" : "insight",
    "directId" : "fitDirectID4",
    "directId2": "direcID4", 
    "branchId": "-!${branchID}!-", 
     "dateOfBirth": null, 
    "gender": "F", 
     "income": null, 
    "retirementAge": 65, 
    "taxId": "999-99-8888", 
    "taxIdType": "SSN", 
    "userClass": "DOUBLE-PLATNUM",
    "companyId" : "-!${companyID}!-",
    "person" : {
      "Person" : {
        "employee" : false,
        "firstName" : "-!${personFirstName}!-",
        "homePhone" : "303-666-6666",
        "id" : null,
        "lastName" : "Badyelkhan",
        "middleName" : "No Middle Name",
        "mobilePhone" : "720-555-5555",
        "primaryEmail" : "test@lodosoftware.com",
        "workPhone" : "920-456-7878",
        "alternateEmail" : "alternateEmail@lodosoftware.com",
        "mailingAddress" : {
          "Address" : {
            "line1" : "1234 Admin Ln",
            "line2" : "1235 Admin Ln",
            "line3" : "1236 Admin Ln",
            "line4" : "1237 Admin Ln",
            "city" : "AnyTown",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "12345",
            "state" : "CO"
          }
        },
        "physicalAddress" : {
          "Address" : {
            "line1" : "5555 Cornhusker Highway",
            "line2" : "5556 Cornhusker Highway",
            "line3" : null,
            "line4" : null,
            "city" : "Lincoln",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "45678",
            "state" : "NE"
          }
        }
      }
    },
    "credentials" : 
     {
      "Credentials" : {
        "password" : "12345645",
        "secretQuestions" : [ {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your mother's maiden name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What was your first pet's name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your favorite color?",
            "secretAnswer" : "denver"
          }
        } ]
      }
    }
  }
}-!|
|POST||200|||
|let||js|!-response.jsonbody-!||
|let|$nonExpectedUserID4|js|!-response.jsonbody.User.userId-!||
|comment|state value is higher than 3 varchar|
|setBody|!-{
  "User" : {
    "loginId" : "stateHigherThan3Char",
    "userId": null, 
    "enabled" : true,
    "userType" : "insight",
    "directId" : "fitDirectID4",
    "directId2": "direcID4", 
    "branchId": "-!${branchID}!-", 
     "dateOfBirth": null, 
    "gender": "F", 
     "income": null, 
    "retirementAge": 65, 
    "taxId": "999-99-8888", 
    "taxIdType": "SSN", 
    "userClass": "DOUBLE-PLATNUM",
    "companyId" : "-!${companyID}!-",
    "person" : {
      "Person" : {
        "employee" : false,
        "firstName" : "-!${personFirstName}!-",
        "homePhone" : "303-666-6666",
        "id" : null,
        "lastName" : "Badyelkhan",
        "middleName" : "No Middle Name",
        "mobilePhone" : "720-555-5555",
        "primaryEmail" : "test@lodosoftware.com",
        "workPhone" : "920-456-7878",
        "alternateEmail" : "alternateEmail@lodosoftware.com",
        "mailingAddress" : {
          "Address" : {
            "line1" : "1234 Admin Ln",
            "line2" : "1235 Admin Ln",
            "line3" : "1236 Admin Ln",
            "line4" : "1237 Admin Ln",
            "city" : "AnyTown",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "12345",
            "state" : "Colorado"
          }
        },
        "physicalAddress" : {
          "Address" : {
            "line1" : "5555 Cornhusker Highway",
            "line2" : "5556 Cornhusker Highway",
            "line3" : null,
            "line4" : null,
            "city" : "Lincoln",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "45678",
            "state" : "NE"
          }
        }
      }
    },
    "credentials" : 
     {
      "Credentials" : {
        "password" : "password#1",
        "secretQuestions" : [ {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your mother's maiden name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What was your first pet's name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your favorite color?",
            "secretAnswer" : "denver"
          }
        } ]
      }
    }
  }
}-!|
|POST||400|||
|let||js|!-response.jsonbody.message-!||
|comment|if companyID is null|
|setBody|!-{
  "User" : {
    "loginId" : "stateHigherThan3Char",
    "userId": null, 
    "enabled" : true,
    "userType" : "insight",
    "directId" : "fitDirectID4",
    "directId2": "direcID4", 
    "branchId": "-!${branchID}!-", 
     "dateOfBirth": null, 
    "gender": "F", 
     "income": null, 
    "retirementAge": 65, 
    "taxId": "999-99-8888", 
    "taxIdType": "SSN", 
    "userClass": "DOUBLE-PLATNUM",
    "companyId" : null,
    "person" : {
      "Person" : {
        "employee" : false,
        "firstName" : "-!${personFirstName}!-",
        "homePhone" : "303-666-6666",
        "id" : null,
        "lastName" : "Badyelkhan",
        "middleName" : "No Middle Name",
        "mobilePhone" : "720-555-5555",
        "primaryEmail" : "test@lodosoftware.com",
        "workPhone" : "920-456-7878",
        "alternateEmail" : "alternateEmail@lodosoftware.com",
        "mailingAddress" : {
          "Address" : {
            "line1" : "1234 Admin Ln",
            "line2" : "1235 Admin Ln",
            "line3" : "1236 Admin Ln",
            "line4" : "1237 Admin Ln",
            "city" : "AnyTown",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "12345",
            "state" : "Colorado"
          }
        },
        "physicalAddress" : {
          "Address" : {
            "line1" : "5555 Cornhusker Highway",
            "line2" : "5556 Cornhusker Highway",
            "line3" : null,
            "line4" : null,
            "city" : "Lincoln",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "45678",
            "state" : "NE"
          }
        }
      }
    },
    "credentials" : 
     {
      "Credentials" : {
        "password" : "password#1",
        "secretQuestions" : [ {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your mother's maiden name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What was your first pet's name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your favorite color?",
            "secretAnswer" : "denver"
          }
        } ]
      }
    }
  }
}-!|
|POST||400|||
|let||js|!-response.jsonbody.message-!||
****!
****!
!*****> '''1.1.2.1 Institution User - Create User'''
!*****> '''1.1.2.1 Institution User - Create System User'''
****!
!*****> '''1.1.2.2 Institution User - Create Consumer User'''
****!
!*****> '''1.1.2.3 Institution User - Create Institution User'''
****!
!*****> '''1.1.2.4 Institution User - Create Insight User'''
****!
****!
!*****> '''1.1.3.1 Insight User - Create User'''
!*****> '''1.1.3.1 Insight User - Create System User'''
|!-smartrics.rest.fitnesse.fixture.RestFixture-!|http://${serverName}/d3rest/users|
|setHeader|!- appKey : -!${fiApiKey}!- 
Content-Type : application/json
userToken : %fiEncodedUserToken%-!|
|setBody|!-{
  "User" : {
    "userId": null, 
    "loginId" : "-!${userLoginID}!-5",
    "enabled" : true,
    "userType" : "system",
    "directId" : "fitDirectID5",
    "directId2": "direcID5", 
    "branchId": "-!${branchID}!-", 
    "dateOfBirth": null, 
    "gender": "F", 
    "income": null, 
    "retirementAge": 65, 
    "taxId": "999-99-8888", 
    "taxIdType": "SSN", 
    "userClass": "DOUBLE-PLATNUM",
    "billpaySubscriberId" : "testbillpaySubscriberId",
    "creditScore" : "700",
    "emailOptOut" : false,
    "markedForDelete" : false,
    "interfaceId" : 12,
    "companyId" : "-!${companyID}!-",
    "person" : {
      "Person" : {
        "employee" : false,
        "firstName" : "-!${personFirstName}!-",
        "homePhone" : "303-666-6666",
        "id" : null,
        "lastName" : "Badyelkhan",
        "middleName" : "No Middle Name",
        "mobilePhone" : "720-555-5555",
        "primaryEmail" : "test@lodosoftware.com",
        "workPhone" : "920-456-7878",
        "alternateEmail" : "alternateEmail@lodosoftware.com",
        "mailingAddress" : {
          "Address" : {
            "line1" : "1234 Admin Ln",
            "line2" : "1235 Admin Ln",
            "line3" : "1236 Admin Ln",
            "line4" : "1237 Admin Ln",
            "city" : "AnyTown",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "12345",
            "state" : "CO"
          }
        },
        "physicalAddress" : {
          "Address" : {
            "line1" : "5555 Cornhusker Highway",
            "line2" : "5556 Cornhusker Highway",
            "line3" : null,
            "line4" : null,
            "city" : "Lincoln",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "45678",
            "state" : "NE"
          }
        }
      }
    },
    "credentials" : 
     {
      "Credentials" : {
        "password" : "password#5",
        "secretQuestions" : [ {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your mother's maiden name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What was your first pet's name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your favorite color?",
            "secretAnswer" : "denver"
          }
        } ]
      }
    }
  }
}-!|
|POST||403|||
|let|$errMsg|js|!-response.jsonbody.message-!||

!|com.lodosoftware.fitnesse.fixtures.LodosoftwareFixtures|
|symbolName|str|isContain?|
|errMsg|!-Consumer users do not have permission for this operation.-!|true|
****!
!*****> '''1.1.3.2 Insight User - Create Consumer User'''
|!-smartrics.rest.fitnesse.fixture.RestFixture-!|http://${serverName}/d3rest/users|
|setHeader|!- appKey : -!${fiApiKey}!- 
Content-Type : application/json
userToken : %fiEncodedUserToken%-!|
|setBody|!-{
  "User" : {
    "userId": null, 
    "loginId" : "-!${userLoginID}!-5",
    "enabled" : true,
    "userType" : "consumer",
    "directId" : "fitDirectID5",
    "directId2": "direcID5", 
    "branchId": "-!${branchID}!-", 
    "dateOfBirth": null, 
    "gender": "F", 
    "income": null, 
    "retirementAge": 65, 
    "taxId": "999-99-8888", 
    "taxIdType": "SSN", 
    "userClass": "DOUBLE-PLATNUM",
    "billpaySubscriberId" : "testbillpaySubscriberId",
    "creditScore" : "700",
    "emailOptOut" : false,
    "markedForDelete" : false,
    "interfaceId" : 12,
    "companyId" : "-!${companyID}!-",
    "person" : {
      "Person" : {
        "employee" : false,
        "firstName" : "-!${personFirstName}!-",
        "homePhone" : "303-666-6666",
        "id" : null,
        "lastName" : "Badyelkhan",
        "middleName" : "No Middle Name",
        "mobilePhone" : "720-555-5555",
        "primaryEmail" : "test@lodosoftware.com",
        "workPhone" : "920-456-7878",
        "alternateEmail" : "alternateEmail@lodosoftware.com",
        "mailingAddress" : {
          "Address" : {
            "line1" : "1234 Admin Ln",
            "line2" : "1235 Admin Ln",
            "line3" : "1236 Admin Ln",
            "line4" : "1237 Admin Ln",
            "city" : "AnyTown",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "12345",
            "state" : "CO"
          }
        },
        "physicalAddress" : {
          "Address" : {
            "line1" : "5555 Cornhusker Highway",
            "line2" : "5556 Cornhusker Highway",
            "line3" : null,
            "line4" : null,
            "city" : "Lincoln",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "45678",
            "state" : "NE"
          }
        }
      }
    },
    "credentials" : 
     {
      "Credentials" : {
        "password" : "password#5",
        "secretQuestions" : [ {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your mother's maiden name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What was your first pet's name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your favorite color?",
            "secretAnswer" : "denver"
          }
        } ]
      }
    }
  }
}-!|
|POST||403|||
|let|$errMsg|js|!-response.jsonbody.message-!||

!|com.lodosoftware.fitnesse.fixtures.LodosoftwareFixtures|
|symbolName|str|isContain?|
|errMsg|!-Consumer users do not have permission for this operation-!|true|
****!
!*****> '''1.1.3.3 Insight User - Create Institution User'''
|!-smartrics.rest.fitnesse.fixture.RestFixture-!|http://${serverName}/d3rest/users|
|setHeader|!- appKey : -!${fiApiKey}!- 
Content-Type : application/json
userToken : %fiEncodedUserToken%-!|
|setBody|!-{
  "User" : {
    "userId": null, 
    "loginId" : "-!${userLoginID}!-5",
    "enabled" : true,
    "userType" : "institution",
    "directId" : "fitDirectID5",
    "directId2": "direcID5", 
    "branchId": "-!${branchID}!-", 
    "dateOfBirth": null, 
    "gender": "F", 
    "income": null, 
    "retirementAge": 65, 
    "taxId": "999-99-8888", 
    "taxIdType": "SSN", 
    "userClass": "DOUBLE-PLATNUM",
    "billpaySubscriberId" : "testbillpaySubscriberId",
    "creditScore" : "700",
    "emailOptOut" : false,
    "markedForDelete" : false,
    "interfaceId" : 12,
    "companyId" : "-!${companyID}!-",
    "person" : {
      "Person" : {
        "employee" : false,
        "firstName" : "-!${personFirstName}!-",
        "homePhone" : "303-666-6666",
        "id" : null,
        "lastName" : "Badyelkhan",
        "middleName" : "No Middle Name",
        "mobilePhone" : "720-555-5555",
        "primaryEmail" : "test@lodosoftware.com",
        "workPhone" : "920-456-7878",
        "alternateEmail" : "alternateEmail@lodosoftware.com",
        "mailingAddress" : {
          "Address" : {
            "line1" : "1234 Admin Ln",
            "line2" : "1235 Admin Ln",
            "line3" : "1236 Admin Ln",
            "line4" : "1237 Admin Ln",
            "city" : "AnyTown",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "12345",
            "state" : "CO"
          }
        },
        "physicalAddress" : {
          "Address" : {
            "line1" : "5555 Cornhusker Highway",
            "line2" : "5556 Cornhusker Highway",
            "line3" : null,
            "line4" : null,
            "city" : "Lincoln",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "45678",
            "state" : "NE"
          }
        }
      }
    },
    "credentials" : 
     {
      "Credentials" : {
        "password" : "password#5",
        "secretQuestions" : [ {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your mother's maiden name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What was your first pet's name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your favorite color?",
            "secretAnswer" : "denver"
          }
        } ]
      }
    }
  }
}-!|
|POST||403|||
|let|$errMsg|js|!-response.jsonbody.message-!||

!|com.lodosoftware.fitnesse.fixtures.LodosoftwareFixtures|
|symbolName|str|isContain?|
|errMsg|!-Consumer users do not have permission for this operation-!|true|

****!
!*****> '''1.1.3.4 Insight User - Create Insight User'''
|!-smartrics.rest.fitnesse.fixture.RestFixture-!|http://${serverName}/d3rest/users|
|setHeader|!- appKey : -!${fiApiKey}!- 
Content-Type : application/json
userToken : %fiEncodedUserToken%-!|
|setBody|!-{
  "User" : {
    "userId": null, 
    "loginId" : "-!${userLoginID}!-5",
    "enabled" : true,
    "userType" : "insight",
    "directId" : "fitDirectID5",
    "directId2": "direcID5", 
    "branchId": "-!${branchID}!-", 
    "dateOfBirth": null, 
    "gender": "F", 
    "income": null, 
    "retirementAge": 65, 
    "taxId": "999-99-8888", 
    "taxIdType": "SSN", 
    "userClass": "DOUBLE-PLATNUM",
    "billpaySubscriberId" : "testbillpaySubscriberId",
    "creditScore" : "700",
    "emailOptOut" : false,
    "markedForDelete" : false,
    "interfaceId" : 12,
    "companyId" : "-!${companyID}!-",
    "person" : {
      "Person" : {
        "employee" : false,
        "firstName" : "-!${personFirstName}!-",
        "homePhone" : "303-666-6666",
        "id" : null,
        "lastName" : "Badyelkhan",
        "middleName" : "No Middle Name",
        "mobilePhone" : "720-555-5555",
        "primaryEmail" : "test@lodosoftware.com",
        "workPhone" : "920-456-7878",
        "alternateEmail" : "alternateEmail@lodosoftware.com",
        "mailingAddress" : {
          "Address" : {
            "line1" : "1234 Admin Ln",
            "line2" : "1235 Admin Ln",
            "line3" : "1236 Admin Ln",
            "line4" : "1237 Admin Ln",
            "city" : "AnyTown",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "12345",
            "state" : "CO"
          }
        },
        "physicalAddress" : {
          "Address" : {
            "line1" : "5555 Cornhusker Highway",
            "line2" : "5556 Cornhusker Highway",
            "line3" : null,
            "line4" : null,
            "city" : "Lincoln",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "45678",
            "state" : "NE"
          }
        }
      }
    },
    "credentials" : 
     {
      "Credentials" : {
        "password" : "password#5",
        "secretQuestions" : [ {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your mother's maiden name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What was your first pet's name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your favorite color?",
            "secretAnswer" : "denver"
          }
        } ]
      }
    }
  }
}-!|
|POST||403|||
|let|$errMsg|js|!-response.jsonbody.message-!||

!|com.lodosoftware.fitnesse.fixtures.LodosoftwareFixtures|
|symbolName|str|isContain?|
|errMsg|!-Consumer users do not have permission for this operation-!|true|
****!
****!
!*****> '''1.1.4.1 Consumer User - Create User'''
!*****> '''1.1.4.1 Consumer User - Create System User'''
|!-smartrics.rest.fitnesse.fixture.RestFixture-!|http://${serverName}/d3rest/users|
|setHeader|!- appKey : -!${institutionNum}!- 
Content-Type : application/json
userToken : %encodedUserToken%-!|
|setBody|!-{
  "User" : {
    "userId": null, 
    "loginId" : "-!${userLoginID}!-5",
    "enabled" : true,
    "userType" : "system",
    "directId" : "fitDirectID5",
    "directId2": "direcID5", 
    "branchId": "-!${branchID}!-", 
    "dateOfBirth": null, 
    "gender": "F", 
    "income": null, 
    "retirementAge": 65, 
    "taxId": "999-99-8888", 
    "taxIdType": "SSN", 
    "userClass": "DOUBLE-PLATNUM",
    "billpaySubscriberId" : "testbillpaySubscriberId",
    "creditScore" : "700",
    "emailOptOut" : false,
    "markedForDelete" : false,
    "interfaceId" : 12,
    "companyId" : "-!${companyID}!-",
    "person" : {
      "Person" : {
        "employee" : false,
        "firstName" : "-!${personFirstName}!-",
        "homePhone" : "303-666-6666",
        "id" : null,
        "lastName" : "Badyelkhan",
        "middleName" : "No Middle Name",
        "mobilePhone" : "720-555-5555",
        "primaryEmail" : "test@lodosoftware.com",
        "workPhone" : "920-456-7878",
        "alternateEmail" : "alternateEmail@lodosoftware.com",
        "mailingAddress" : {
          "Address" : {
            "line1" : "1234 Admin Ln",
            "line2" : "1235 Admin Ln",
            "line3" : "1236 Admin Ln",
            "line4" : "1237 Admin Ln",
            "city" : "AnyTown",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "12345",
            "state" : "CO"
          }
        },
        "physicalAddress" : {
          "Address" : {
            "line1" : "5555 Cornhusker Highway",
            "line2" : "5556 Cornhusker Highway",
            "line3" : null,
            "line4" : null,
            "city" : "Lincoln",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "45678",
            "state" : "NE"
          }
        }
      }
    },
    "credentials" : 
     {
      "Credentials" : {
        "password" : "password#5",
        "secretQuestions" : [ {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your mother's maiden name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What was your first pet's name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your favorite color?",
            "secretAnswer" : "denver"
          }
        } ]
      }
    }
  }
}-!|
|POST||400|||
|let|$errMsg|js|!-response.jsonbody.message-!||

!|com.lodosoftware.fitnesse.fixtures.LodosoftwareFixtures|
|symbolName|str|isContain?|
|errMsg|!-ErrorCode: 300200 - Operation requires Admin User.-!|true|
****!
!*****> '''1.1.4.2 Consumer User - Create Consumer User'''
|!-smartrics.rest.fitnesse.fixture.RestFixture-!|http://${serverName}/d3rest/users|
|setHeader|!- appKey : -!${institutionNum}!- 
Content-Type : application/json
userToken : %encodedUserToken%-!|
|setBody|!-{
  "User" : {
    "userId": null, 
    "loginId" : "-!${userLoginID}!-5",
    "enabled" : true,
    "userType" : "consumer",
    "directId" : "fitDirectID5",
    "directId2": "direcID5", 
    "branchId": "-!${branchID}!-", 
    "dateOfBirth": null, 
    "gender": "F", 
    "income": null, 
    "retirementAge": 65, 
    "taxId": "999-99-8888", 
    "taxIdType": "SSN", 
    "userClass": "DOUBLE-PLATNUM",
    "billpaySubscriberId" : "testbillpaySubscriberId",
    "creditScore" : "700",
    "emailOptOut" : false,
    "markedForDelete" : false,
    "interfaceId" : 12,
    "companyId" : "-!${companyID}!-",
    "person" : {
      "Person" : {
        "employee" : false,
        "firstName" : "-!${personFirstName}!-",
        "homePhone" : "303-666-6666",
        "id" : null,
        "lastName" : "Badyelkhan",
        "middleName" : "No Middle Name",
        "mobilePhone" : "720-555-5555",
        "primaryEmail" : "test@lodosoftware.com",
        "workPhone" : "920-456-7878",
        "alternateEmail" : "alternateEmail@lodosoftware.com",
        "mailingAddress" : {
          "Address" : {
            "line1" : "1234 Admin Ln",
            "line2" : "1235 Admin Ln",
            "line3" : "1236 Admin Ln",
            "line4" : "1237 Admin Ln",
            "city" : "AnyTown",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "12345",
            "state" : "CO"
          }
        },
        "physicalAddress" : {
          "Address" : {
            "line1" : "5555 Cornhusker Highway",
            "line2" : "5556 Cornhusker Highway",
            "line3" : null,
            "line4" : null,
            "city" : "Lincoln",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "45678",
            "state" : "NE"
          }
        }
      }
    },
    "credentials" : 
     {
      "Credentials" : {
        "password" : "password#5",
        "secretQuestions" : [ {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your mother's maiden name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What was your first pet's name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your favorite color?",
            "secretAnswer" : "denver"
          }
        } ]
      }
    }
  }
}-!|
|POST||400|||
|let|$errMsg|js|!-response.jsonbody.message-!||

!|com.lodosoftware.fitnesse.fixtures.LodosoftwareFixtures|
|symbolName|str|isContain?|
|errMsg|!-ErrorCode: 300200 - Operation requires Admin User.-!|true|

!|com.lodosoftware.fitnesse.fixtures.LodosoftwareFixtures|
|symbolName|str|isContain?|
|errMsg|!-ErrorCode: 300200 - Operation requires Admin User.-!|true|
****!
!*****> '''1.1.4.3 Consumer User - Create Institution User'''
|!-smartrics.rest.fitnesse.fixture.RestFixture-!|http://${serverName}/d3rest/users|
|setHeader|!- appKey : -!${institutionNum}!- 
Content-Type : application/json
userToken : %encodedUserToken%-!|
|setBody|!-{
  "User" : {
    "userId": null, 
    "loginId" : "-!${userLoginID}!-5",
    "enabled" : true,
    "userType" : "institution",
    "directId" : "fitDirectID5",
    "directId2": "direcID5", 
    "branchId": "-!${branchID}!-", 
    "dateOfBirth": null, 
    "gender": "F", 
    "income": null, 
    "retirementAge": 65, 
    "taxId": "999-99-8888", 
    "taxIdType": "SSN", 
    "userClass": "DOUBLE-PLATNUM",
    "billpaySubscriberId" : "testbillpaySubscriberId",
    "creditScore" : "700",
    "emailOptOut" : false,
    "markedForDelete" : false,
    "interfaceId" : 12,
    "companyId" : "-!${companyID}!-",
    "person" : {
      "Person" : {
        "employee" : false,
        "firstName" : "-!${personFirstName}!-",
        "homePhone" : "303-666-6666",
        "id" : null,
        "lastName" : "Badyelkhan",
        "middleName" : "No Middle Name",
        "mobilePhone" : "720-555-5555",
        "primaryEmail" : "test@lodosoftware.com",
        "workPhone" : "920-456-7878",
        "alternateEmail" : "alternateEmail@lodosoftware.com",
        "mailingAddress" : {
          "Address" : {
            "line1" : "1234 Admin Ln",
            "line2" : "1235 Admin Ln",
            "line3" : "1236 Admin Ln",
            "line4" : "1237 Admin Ln",
            "city" : "AnyTown",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "12345",
            "state" : "CO"
          }
        },
        "physicalAddress" : {
          "Address" : {
            "line1" : "5555 Cornhusker Highway",
            "line2" : "5556 Cornhusker Highway",
            "line3" : null,
            "line4" : null,
            "city" : "Lincoln",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "45678",
            "state" : "NE"
          }
        }
      }
    },
    "credentials" : 
     {
      "Credentials" : {
        "password" : "password#5",
        "secretQuestions" : [ {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your mother's maiden name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What was your first pet's name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your favorite color?",
            "secretAnswer" : "denver"
          }
        } ]
      }
    }
  }
}-!|
|POST||400|||
|let|$errMsg|js|!-response.jsonbody.message-!||

!|com.lodosoftware.fitnesse.fixtures.LodosoftwareFixtures|
|symbolName|str|isContain?|
|errMsg|!-ErrorCode: 300200 - Operation requires Admin User.-!|true|
****!
!*****> '''1.1.4.4 Consumer User - Create Insight User'''
|!-smartrics.rest.fitnesse.fixture.RestFixture-!|http://${serverName}/d3rest/users|
|setHeader|!- appKey : -!${institutionNum}!- 
Content-Type : application/json
userToken : %encodedUserToken%-!|
|setBody|!-{
  "User" : {
    "userId": null, 
    "loginId" : "-!${userLoginID}!-5",
    "enabled" : true,
    "userType" : "insight",
    "directId" : "fitDirectID5",
    "directId2": "direcID5", 
    "branchId": "-!${branchID}!-", 
    "dateOfBirth": null, 
    "gender": "F", 
    "income": null, 
    "retirementAge": 65, 
    "taxId": "999-99-8888", 
    "taxIdType": "SSN", 
    "userClass": "DOUBLE-PLATNUM",
    "billpaySubscriberId" : "testbillpaySubscriberId",
    "creditScore" : "700",
    "emailOptOut" : false,
    "markedForDelete" : false,
    "interfaceId" : 12,
    "companyId" : "-!${companyID}!-",
    "person" : {
      "Person" : {
        "employee" : false,
        "firstName" : "-!${personFirstName}!-",
        "homePhone" : "303-666-6666",
        "id" : null,
        "lastName" : "Badyelkhan",
        "middleName" : "No Middle Name",
        "mobilePhone" : "720-555-5555",
        "primaryEmail" : "test@lodosoftware.com",
        "workPhone" : "920-456-7878",
        "alternateEmail" : "alternateEmail@lodosoftware.com",
        "mailingAddress" : {
          "Address" : {
            "line1" : "1234 Admin Ln",
            "line2" : "1235 Admin Ln",
            "line3" : "1236 Admin Ln",
            "line4" : "1237 Admin Ln",
            "city" : "AnyTown",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "12345",
            "state" : "CO"
          }
        },
        "physicalAddress" : {
          "Address" : {
            "line1" : "5555 Cornhusker Highway",
            "line2" : "5556 Cornhusker Highway",
            "line3" : null,
            "line4" : null,
            "city" : "Lincoln",
            "countryCode" : "US",
            "geoCode" : null,
            "id" : null,
            "postalCode" : "45678",
            "state" : "NE"
          }
        }
      }
    },
    "credentials" : 
     {
      "Credentials" : {
        "password" : "password#5",
        "secretQuestions" : [ {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your mother's maiden name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What was your first pet's name?",
            "secretAnswer" : "denver"
          }
        }, {
          "SecretQuestionAnswer" : {
            "secretQuestion" : "What is your favorite color?",
            "secretAnswer" : "denver"
          }
        } ]
      }
    }
  }
}-!|
|POST||400|||
|let|$errMsg|js|!-response.jsonbody.message-!||

!|com.lodosoftware.fitnesse.fixtures.LodosoftwareFixtures|
|symbolName|str|isContain?|
|errMsg|!-ErrorCode: 300200 - Operation requires Admin User.-!|true|
****!
****!
****!
****!
!*****> '''Get User Token - Consumer User'''
|!-smartrics.rest.fitnesse.fixture.RestFixture-!|http://${serverName}/d3rest/challenge|
|setHeader|!- appKey : -!${institutionNum}!- 
Content-Type : application/json
Accept : application/json-!|
|setBody|!-{"AuthenticationChallenge":{"authToken":null,"isAuthenticated":null,"errorMessage":null,"nextChallenge":null,"currentChallenge":null,"isChallengeSuccess":null,"challengeList":null}}-!|
|POST||200|||
|setBody|!-{"AuthenticationChallenge":{"authToken":null,"isAuthenticated":false,"errorMessage":null,"nextChallenge":"challenge.type.username.and.password","currentChallenge":"challenge.type.username.and.password","isChallengeSuccess":true,"challengeList":[{"AuthenticationChallengeItem":{"key":"challenge.item.type.username","value":"fitTestLogin2"}},{"AuthenticationChallengeItem":{"key":"challenge.item.type.password","value":"password#2"}}]}}-!|
|POST||200|||
|let|$token|js|response.jsonbody.AuthenticationChallenge.authToken||

!|com.lodosoftware.fitnesse.fixtures.LodosoftwareFixtures|
|symbolName|=getToken?|
|token|myToken|

|!-smartrics.rest.fitnesse.fixture.RestFixture-!|http://${serverName}/d3rest/challenge|
|setHeader|!- appKey : -!${institutionNum}!- 
Content-Type : application/json
Accept : application/json-!|
|setBody|!-{"AuthenticationChallenge":{"authToken":"-!%myToken%!-","isAuthenticated":false,"errorMessage":null,"nextChallenge":"challenge.type.secret.question","currentChallenge":"challenge.type.secret.question","isChallengeSuccess":true,"challengeList":[{"AuthenticationChallengeItem":{"key":"challenge.item.type.secret.question","value":"denver"}}]}}-!|
|POST||200|||
|let|authenticated|js|response.jsonbody.AuthenticationChallenge.isAuthenticated|false|
|let|$userToken|js|response.jsonbody.AuthenticationChallenge.authToken||


|!-smartrics.rest.fitnesse.fixture.RestFixture-!|http://${serverName}/d3rest/challenge|
|setHeader|!- appKey : -!${institutionNum}!- 
Content-Type : application/json
Accept : application/json-!|
|setBody|!-{
    "AuthenticationChallenge": {
        "authToken": "-!%userToken%!-", 
        "isAuthenticated": false, 
        "errorMessage": null, 
        "nextChallenge": "challenge.type.terms.of.service", 
        "currentChallenge": "challenge.type.terms.of.service", 
        "isChallengeSuccess": true, 
        "challengeList": [
            {
                "AuthenticationChallengeItem": {
                    "key": "challenge.item.type.terms.of.service", 
                    "value": "true"
                }
            }
        ]
    }
}
-!|
|POST||200|||
|let||js|response.jsonbody.AuthenticationChallenge.isAuthenticated|true|
|let|$userToken|js|response.jsonbody.AuthenticationChallenge.authToken||


|!-org.eclg.fitnesse.tools.StringFixture-!|
|value| =urlencode()|
|%userToken%|encodedUser2Token|
****!
****!